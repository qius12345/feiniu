define("config/item_config",[],function(){return{chooseShop:null,arrIfno:[],sm_seq:"",J_tie_index:0,tabClas:"salepackage",num:0,countNum:[],colloNum:0,_activityID:null,_randcoe:null,_server_time:null,_sign:null,_privilege:0}}),!function(){function S(e){return e.replace(m,"").replace(g,",").replace(y,"").replace(b,"").replace(w,"").split(E)}function x(e){return"'"+e.replace(/('|\\)/g,"\\$1").replace(/\r/g,"\\r").replace(/\n/g,"\\n")+"'"}function T(e,t){function C(e){return a+=e.split(/\n/).length-1,o&&(e=e.replace(/\s+/g," ").replace(/<!--[\w\W]*?-->/g,"")),e&&(e=p[1]+x(e)+p[2]+"\n"),e}function k(e){var r=a;s?e=s(e,t):n&&(e=e.replace(/\n/g,function(){return a++,"$line="+a+";"}));if(e.indexOf("=")===0){var i=u&&!/^=[=#]/.test(e);e=e.replace(/^=[=#]?|[\s;]*$/g,"");if(i){var o=e.replace(/\s*\([^\)]+\)/,"");!l[o]&&!/^(include|print)$/.test(o)&&(e="$escape("+e+")")}else e="$string("+e+")";e=p[1]+e+p[2]}return n&&(e="$line="+r+";"+e),d(S(e),function(e){if(!e||f[e])return;var t;e==="print"?t=m:e==="include"?t=g:l[e]?t="$utils."+e:c[e]?t="$helpers."+e:t="$data."+e,y+=e+"="+t+",",f[e]=!0}),e+"\n"}var n=t.debug,r=t.openTag,i=t.closeTag,s=t.parser,o=t.compress,u=t.escape,a=1,f={$data:1,$filename:1,$utils:1,$helpers:1,$out:1,$line:1},h="".trim,p=h?["$out='';","$out+=",";","$out"]:["$out=[];","$out.push(",");","$out.join('')"],v=h?"$out+=text;return $out;":"$out.push(text);",m="function(){var text=''.concat.apply('',arguments);"+v+"}",g="function(filename,data){data=data||$data;var text=$utils.$include(filename,data,$filename);"+v+"}",y="var $utils=this,$helpers=$utils.$helpers,"+(n?"$line=0,":""),b=p[0],w="return new String("+p[3]+");";d(e.split(r),function(e){e=e.split(i);var t=e[0],n=e[1];e.length===1?b+=C(t):(b+=k(t),n&&(b+=C(n)))});var E=y+b+w;n&&(E="try{"+E+"}catch(e){"+"throw {"+"filename:$filename,"+"name:'Render Error',"+"message:e.message,"+"line:$line,"+"source:"+x(e)+".split(/\\n/)[$line-1].replace(/^\\s+/,'')"+"};"+"}");try{var T=new Function("$data","$filename",E);return T.prototype=l,T}catch(N){throw N.temp="function anonymous($data,$filename) {"+E+"}",N}}var e=function(e,t){return typeof t=="string"?p(t,{filename:e}):r(e,t)};e.version="3.0.0",e.config=function(e,n){t[e]=n};var t=e.defaults={openTag:"<%",closeTag:"%>",escape:!0,cache:!0,compress:!1,parser:null},n=e.cache={};e.render=function(e,t){return p(e,t)};var r=e.renderFile=function(t,n){var r=e.get(t)||h({filename:t,name:"Render Error",message:"Template not found"});return n?r(n):r};e.get=function(e){var t;if(n[e])t=n[e];else if(typeof document=="object"){var r=document.getElementById(e);if(r){var i=(r.value||r.innerHTML).replace(/^\s*|\s*$/g,"");t=p(i,{filename:e})}}return t};var i=function(e,t){return typeof e!="string"&&(t=typeof e,t==="number"?e+="":t==="function"?e=i(e.call(e)):e=""),e},s={"<":"&#60;",">":"&#62;",'"':"&#34;","'":"&#39;","&":"&#38;"},o=function(e){return s[e]},u=function(e){return i(e).replace(/&(?![\w#]+;)|[<>"']/g,o)},a=Array.isArray||function(e){return{}.toString.call(e)==="[object Array]"},f=function(e,t){var n,r;if(a(e))for(n=0,r=e.length;n<r;n++)t.call(e,e[n],n,e);else for(n in e)t.call(e,e[n],n)},l=e.utils={$helpers:{},$include:r,$string:i,$escape:u,$each:f};e.helper=function(e,t){c[e]=t};var c=e.helpers=l.$helpers;e.onerror=function(e){var t="Template Error\n\n";for(var n in e)t+="<"+n+">\n"+e[n]+"\n\n";typeof console=="object"&&console.error(t)};var h=function(t){return e.onerror(t),function(){return"{Template Error}"}},p=e.compile=function(e,r){function a(t){try{return new o(t,s)+""}catch(n){return r.debug?h(n)():(r.debug=!0,p(e,r)(t))}}r=r||{};for(var i in t)r[i]===undefined&&(r[i]=t[i]);var s=r.filename;try{var o=T(e,r)}catch(u){return u.filename=s||"anonymous",u.name="Syntax Error",h(u)}return a.prototype=o.prototype,a.toString=function(){return o.toString()},s&&r.cache&&(n[s]=a),a},d=l.$each,v="break,case,catch,continue,debugger,default,delete,do,else,false,finally,for,function,if,in,instanceof,new,null,return,switch,this,throw,true,try,typeof,var,void,while,with,abstract,boolean,byte,char,class,const,double,enum,export,extends,final,float,goto,implements,import,int,interface,long,native,package,private,protected,public,short,static,super,synchronized,throws,transient,volatile,arguments,let,yield,undefined",m=/\/\*[\w\W]*?\*\/|\/\/[^\n]*\n|\/\/[^\n]*$|"(?:[^"\\]|\\[\w\W])*"|'(?:[^'\\]|\\[\w\W])*'|\s*\.\s*[$\w\.]+/g,g=/[^\w$]+/g,y=new RegExp(["\\b"+v.replace(/,/g,"\\b|\\b")+"\\b"].join("|"),"g"),b=/^\d[^,]*|,\d[^,]*/g,w=/^,+|,+$/g,E=/^$|,+/;t.openTag="{{",t.closeTag="}}";var N=function(e,t){var n=t.split(":"),r=n.shift(),i=n.join(":")||"";return i&&(i=", "+i),"$helpers."+r+"("+e+i+")"};t.parser=function(t,n){t=t.replace(/^\s/,"");var r=t.split(" "),i=r.shift(),s=r.join(" ");switch(i){case"if":t="if("+s+"){";break;case"else":r.shift()==="if"?r=" if("+r.join(" ")+")":r="",t="}else"+r+"{";break;case"/if":t="}";break;case"each":var o=r[0]||"$data",u=r[1]||"as",a=r[2]||"$value",f=r[3]||"$index",l=a+","+f;u!=="as"&&(o="[]"),t="$each("+o+",function("+l+"){";break;case"/each":t="});";break;case"echo":t="print("+s+");";break;case"print":case"include":t=i+"("+r.join(",")+");";break;default:if(/^\s*\|\s*[\w\$]/.test(s)){var c=!0;t.indexOf("#")===0&&(t=t.substr(1),c=!1);var h=0,p=t.split("|"),d=p.length,v=p[h++];for(;h<d;h++)v=N(v,p[h]);t=(c?"=":"=#")+v}else e.helpers[i]?t="=#"+i+"("+r.join(",")+");":t="="+t}return t},typeof define=="function"?define("lib/template",[],function(){return e}):typeof exports!="undefined"?module.exports=e:this.template=e}(),define("widget/popup",["lib/jquery/1.11.1/jquery-1.11.1"],function(e){function i(){this.destroyed=!1,this.__popup=$("<div />").css({display:"none",position:"absolute",outline:0}).attr("tabindex","-1").html(this.innerHTML).appendTo("body"),this.__backdrop=this.__mask=$("<div />").css({opacity:.7,background:"#000"}),this.node=this.__popup[0],this.backdrop=this.__backdrop[0],t++}var t=0,n=!("minWidth"in $("html")[0].style),r=!n;return $.extend(i.prototype,{node:null,backdrop:null,fixed:!1,destroyed:!0,open:!1,returnValue:"",autofocus:!0,align:"bottom left",innerHTML:"",className:"ui-popup",show:function(e){if(this.destroyed)return this;var t=this,s=this.__popup,o=this.__backdrop;this.__activeElement=this.__getActive(),this.open=!0,this.follow=e||this.follow;if(!this.__ready){s.addClass(this.className).attr("role",this.modal?"alertdialog":"dialog").css("position",this.fixed?"fixed":"absolute"),n||$(window).on("resize",$.proxy(this.reset,this));if(this.modal){var u={position:"fixed",left:0,top:0,width:"100%",height:"100%",overflow:"hidden",userSelect:"none",zIndex:this.zIndex||i.zIndex};s.addClass(this.className+"-modal"),r||$.extend(u,{position:"absolute",width:$(window).width()+"px",height:$(document).height()+"px"}),o.css(u).attr({tabindex:"0"}).on("focus",$.proxy(this.focus,this)),this.__mask=o.clone(!0).attr("style","").insertAfter(s),o.addClass(this.className+"-backdrop").insertBefore(s),this.__ready=!0}s.html()||s.html(this.innerHTML)}return s.addClass(this.className+"-show").show(),o.show(),this.reset().focus(),this.__dispatchEvent("show"),this},showModal:function(){return this.modal=!0,this.show.apply(this,arguments)},close:function(t){return!this.destroyed&&this.open&&(t!==e&&(this.returnValue=t),this.__popup.hide().removeClass(this.className+"-show"),this.__backdrop.hide(),this.open=!1,this.blur(),this.__dispatchEvent("close")),this},remove:function(){if(this.destroyed)return this;this.__dispatchEvent("beforeremove"),i.current===this&&(i.current=null),this.__popup.remove(),this.__backdrop.remove(),this.__mask.remove(),n||$(window).off("resize",this.reset),this.__dispatchEvent("remove");for(var e in this)delete this[e];return this},reset:function(){var e=this.follow;return e?this.__follow(e):this.__center(),this.__dispatchEvent("reset"),this},focus:function(){var e=this.node,t=this.__popup,n=i.current,r=this.zIndex=i.zIndex++;n&&n!==this&&n.blur(!1);if(!$.contains(e,this.__getActive())){var s=t.find("[autofocus]")[0];!this._autofocus&&s?this._autofocus=!0:s=e,this.__focus(s)}return t.css("zIndex",r),i.current=this,t.addClass(this.className+"-focus"),this.__dispatchEvent("focus"),this},blur:function(){var e=this.__activeElement,t=arguments[0];return t!==!1&&this.__focus(e),this._autofocus=!1,this.__popup.removeClass(this.className+"-focus"),this.__dispatchEvent("blur"),this},addEventListener:function(e,t){return this.__getEventListener(e).push(t),this},removeEventListener:function(e,t){var n=this.__getEventListener(e);for(var r=0;r<n.length;r++)t===n[r]&&n.splice(r--,1);return this},__getEventListener:function(e){var t=this.__listener;return t||(t=this.__listener={}),t[e]||(t[e]=[]),t[e]},__dispatchEvent:function(e){var t=this.__getEventListener(e);this["on"+e]&&this["on"+e]();for(var n=0;n<t.length;n++)t[n].call(this)},__focus:function(e){try{this.autofocus&&!/^iframe$/i.test(e.nodeName)&&e.focus()}catch(t){}},__getActive:function(){try{var e=document.activeElement,t=e.contentDocument,n=t&&t.activeElement||e;return n}catch(r){}},__center:function(){var e=this.__popup,t=$(window),n=$(document),r=this.fixed,i=r?0:n.scrollLeft(),s=r?0:n.scrollTop(),o=t.width(),u=t.height(),a=e.width(),f=e.height(),l=(o-a)/2+i,c=(u-f)*382/1e3+s,h=e[0].style;h.left=Math.max(parseInt(l),i)+"px",h.top=Math.max(parseInt(c),s)+"px"},__follow:function(e){var t=e.parentNode&&$(e),n=this.__popup;this.__followSkin&&n.removeClass(this.__followSkin);if(t){var r=t.offset();if(r.left*r.top<0)return this.__center()}var i=this,s=this.fixed,o=$(window),u=$(document),a=o.width(),f=o.height(),l=u.scrollLeft(),c=u.scrollTop(),h=n.width(),p=n.height(),d=t?t.outerWidth():0,v=t?t.outerHeight():0,m=this.__offset(e),g=m.left,y=m.top,b=s?g-l:g,w=s?y-c:y,E=s?0:l,S=s?0:c,x=E+a-h,T=S+f-p,N={},C=this.align.split(" "),k=this.className+"-",L={top:"bottom",bottom:"top",left:"right",right:"left"},A={top:"top",bottom:"top",left:"left",right:"left"},O=[{top:w-p,bottom:w+v,left:b-h,right:b+d},{top:w,bottom:w-p+v,left:b,right:b-h+d}],M={left:b+d/2-h/2,top:w+v/2-p/2},_={left:[E,x],top:[S,T]};$.each(C,function(e,t){O[e][t]>_[A[t]][1]&&(t=C[e]=L[t]),O[e][t]<_[A[t]][0]&&(C[e]=L[t])}),C[1]||(A[C[1]]=A[C[0]]==="left"?"top":"left",O[1][C[1]]=M[A[C[1]]]),k+=C.join("-")+" "+this.className+"-follow",i.__followSkin=k,t&&n.addClass(k),N[A[C[0]]]=parseInt(O[0][C[0]]),N[A[C[1]]]=parseInt(O[1][C[1]]),n.css(N)},__offset:function(e){var t=e.parentNode,n=t?$(e).offset():{left:e.pageX,top:e.pageY};e=t?e:e.target;var r=e.ownerDocument,i=r.defaultView||r.parentWindow;if(i==window)return n;var s=i.frameElement,o=$(r),u=o.scrollLeft(),a=o.scrollTop(),f=$(s).offset(),l=f.left,c=f.top;return{left:n.left+l-u,top:n.top+c-a}}}),i.zIndex=1024,i.current=null,i}),define("widget/dialog-config",[],function(){return{backdropBackground:"#000",backdropOpacity:.7,content:'<span class="ui-dialog-loading">Loading..</span>',title:"",statusbar:"",button:null,ok:null,cancel:null,okValue:"ok",cancelValue:"cancel",cancelDisplay:!0,width:"",height:"",padding:"",skin:"",quickClose:!1,cssUri:"",innerHTML:'<div i="dialog" class="ui-dialog"><div class="ui-dialog-arrow-a"></div><div class="ui-dialog-arrow-b"></div><table class="ui-dialog-grid"><tr><td i="header" class="ui-dialog-header"><button i="close" class="ui-dialog-close">&#215;</button><div i="title" class="ui-dialog-title"></div></td></tr><tr><td i="body" class="ui-dialog-body"><div i="content" class="ui-dialog-content"></div></td></tr><tr><td i="footer" class="ui-dialog-footer"><div i="statusbar" class="ui-dialog-statusbar"></div><div i="button" class="ui-dialog-button"></div></td></tr></table></div>'}}),define("widget/dialog",["lib/jquery/1.11.1/jquery-1.11.1","widget/popup","widget/dialog-config"],function(e,t,n){var r=n.cssUri;if(r){var i=require[require.toUrl?"toUrl":"resolve"];i&&(r=i(r),r='<link rel="stylesheet" href="'+r+'" />',$("base")[0]?$("base").before(r):$("head").append(r))}var s=0,o=new Date-0,u=!("minWidth"in $("html")[0].style),a="createTouch"in document&&!("onmousemove"in document)||/(iPhone|iPad|iPod)/i.test(navigator.userAgent),f=!u&&!a,l=function(t,n,r){var i=t=t||{};if(typeof t=="string"||t.nodeType===1)t={content:t,fixed:!a};t=$.extend(!0,{},l.defaults,t),t.original=i;var u=t.id=t.id||o+s,c=l.get(u);return c?c.focus():(f||(t.fixed=!1),t.quickClose&&(t.modal=!0,t.backdropOpacity=0),$.isArray(t.button)||(t.button=[]),r!==e&&(t.cancel=r),t.cancel&&t.button.push({id:"cancel",value:t.cancelValue,callback:t.cancel,display:t.cancelDisplay}),n!==e&&(t.ok=n),t.ok&&t.button.push({id:"ok",value:t.okValue,callback:t.ok,autofocus:!0}),l.list[u]=new l.create(t))},c=function(){};c.prototype=t.prototype;var h=l.prototype=new c;return l.create=function(e){var n=this;$.extend(this,new t);var r=e.original,i=$(this.node).html(e.innerHTML),o=$(this.backdrop);return this.options=e,this._popup=i,$.each(e,function(e,t){typeof n[e]=="function"?n[e](t):n[e]=t}),e.zIndex&&(t.zIndex=e.zIndex),i.attr({"aria-labelledby":this._$("title").attr("id","title:"+this.id).attr("id"),"aria-describedby":this._$("content").attr("id","content:"+this.id).attr("id")}),this._$("close").css("display",this.cancel===!1?"none":"").attr("title",this.cancelValue).on("click",function(e){n._trigger("cancel"),e.preventDefault()}),this._$("dialog").addClass(this.skin),this._$("body").css("padding",this.padding),e.quickClose&&o.on("onmousedown"in document?"mousedown":"click",function(){return n._trigger("cancel"),!1}),this.addEventListener("show",function(){o.css({opacity:e.opacity,background:e.backdropBackground})}),this._esc=function(e){var r=e.target,i=r.nodeName,s=/^input|textarea$/i,o=t.current===n,u=e.keyCode;if(!o||s.test(i)&&r.type!=="button")return;u===27&&n._trigger("cancel")},$(document).on("keydown",this._esc),this.addEventListener("remove",function(){$(document).off("keydown",this._esc),delete l.list[this.id]}),s++,l.oncreate(this),this},l.create.prototype=h,$.extend(h,{content:function(e){var t=this._$("content");return typeof e=="object"?(e=$(e),t.empty("").append(e.show()),this.addEventListener("remove",function(){$("body").append(e.hide())})):t.html(e),this.reset()},title:function(e){return this._$("title").text(e),this._$("header")[e?"show":"hide"](),this},width:function(e){return this._$("content").css("width",e),this.reset()},height:function(e){return this._$("content").css("height",e),this.reset()},button:function(e){e=e||[];var t=this,n="",r=0;return this.callbacks={},typeof e=="string"?(n=e,r++):$.each(e,function(e,i){var s=i.id=i.id||i.value,o="";t.callbacks[s]=i.callback,i.display===!1?o=' style="display:none"':r++,n+='<button type="button" i-id="'+s+'"'+o+(i.disabled?" disabled":"")+(i.autofocus?' autofocus class="ui-dialog-autofocus"':"")+">"+i.value+"</button>",t._$("button").on("click","[i-id="+s+"]",function(e){var n=$(this);n.attr("disabled")||t._trigger(s),e.preventDefault()})}),this._$("button").html(n),this._$("footer")[r?"show":"hide"](),this},statusbar:function(e){return this._$("statusbar").html(e)[e?"show":"hide"](),this},_$:function(e){return this._popup.find("[i="+e+"]")},_trigger:function(e){var t=this.callbacks[e];return typeof t!="function"||t.call(this)!==!1?this.close().remove():this}}),l.oncreate=$.noop,l.getCurrent=function(){return t.current},l.get=function(t){return t===e?l.list:l.list[t]},l.list={},l.defaults=n,l}),define("widget/drag",["lib/jquery/1.11.1/jquery-1.11.1"],function(e){var t=$(window),n=$(document),r="createTouch"in document,i=document.documentElement,s=!("minWidth"in i.style),o=!s&&"onlosecapture"in i,u="setCapture"in i,a={start:r?"touchstart":"mousedown",over:r?"touchmove":"mousemove",end:r?"touchend":"mouseup"},f=r?function(e){return e.touches||(e=e.originalEvent.touches.item(0)),e}:function(e){return e},l=function(){this.start=$.proxy(this.start,this),this.over=$.proxy(this.over,this),this.end=$.proxy(this.end,this),this.onstart=this.onover=this.onend=$.noop};return l.types=a,l.prototype={start:function(e){return e=this.startFix(e),n.on(a.over,this.over).on(a.end,this.end),this.onstart(e),!1},over:function(e){return e=this.overFix(e),this.onover(e),!1},end:function(e){return e=this.endFix(e),n.off(a.over,this.over).off(a.end,this.end),this.onend(e),!1},startFix:function(e){return e=f(e),this.target=$(e.target),this.selectstart=function(){return!1},n.on("selectstart",this.selectstart).on("dblclick",this.end),o?this.target.on("losecapture",this.end):t.on("blur",this.end),u&&this.target[0].setCapture(),e},overFix:function(e){return e=f(e),e},endFix:function(e){return e=f(e),n.off("selectstart",this.selectstart).off("dblclick",this.end),o?this.target.off("losecapture",this.end):t.off("blur",this.end),u&&this.target[0].releaseCapture(),e}},l.create=function(e,r){var i=$(e),s=new l,o=l.types.start,u=function(){},a=e.className.replace(/^\s|\s.*/g,"")+"-drag-start",f,c,h,p,d={onstart:u,onover:u,onend:u,off:function(){i.off(o,s.start)}};return s.onstart=function(r){var s=i.css("position")==="fixed",o=n.scrollLeft(),u=n.scrollTop(),l=i.width(),v=i.height();f=0,c=0,h=s?t.width()-l+f:n.width()-l,p=s?t.height()-v+c:n.height()-v;var m=i.offset(),g=this.startLeft=s?m.left-o:m.left,y=this.startTop=s?m.top-u:m.top;this.clientX=r.clientX,this.clientY=r.clientY,i.addClass(a),d.onstart.call(e,r,g,y)},s.onover=function(t){var n=t.clientX-this.clientX+this.startLeft,r=t.clientY-this.clientY+this.startTop,s=i[0].style;n=Math.max(f,Math.min(h,n)),r=Math.max(c,Math.min(p,r)),s.left=n+"px",s.top=r+"px",d.onover.call(e,t,n,r)},s.onend=function(t){var n=i.position(),r=n.left,s=n.top;i.removeClass(a),d.onend.call(e,t,r,s)},s.off=function(){i.off(o,s.start)},r?s.start(r):i.on(o,s.start),d},l}),define("widget/dialog-plus",["lib/jquery/1.11.1/jquery-1.11.1","widget/dialog","widget/drag"],function(e,t,n){return t.oncreate=function(e){var t=e.options,r=t.original,i=t.url,s=t.oniframeload,o;i&&(this.padding=t.padding=0,o=$("<iframe />"),o.attr({src:i,name:e.id,width:"100%",height:"100%",allowtransparency:"yes",frameborder:"no",scrolling:"no"}).on("load",function(){var n;try{n=o[0].contentWindow.frameElement}catch(r){}n&&(t.width||e.width(o.contents().width()),t.height||e.height(o.contents().height())),s&&s.call(e)}),e.addEventListener("beforeremove",function(){o.attr("src","about:blank").remove()},!1),e.content(o[0]),e.iframeNode=o[0]);if(!(r instanceof Object)){var u=function(){e.close().remove()};for(var a=0;a<frames.length;a++)try{if(r instanceof frames[a].Object){$(frames[a]).one("unload",u);break}}catch(f){}}$(e.node).on(n.types.start,"[i=title]",function(t){e.follow||(e.focus(),n.create(e.node,t))})},t.get=function(e){if(e&&e.frameElement){var n=e.frameElement,r=t.list,i;for(var s in r){i=r[s];if(i.node.getElementsByTagName("iframe")[0]===n)return i}}else if(e)return t.list[e]},t}),function(){function e(){_keyStr="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",this.encode=function(e){var t="",n,r,i,s,o,u,a,f=0;e=_utf8_encode(e);while(f<e.length)n=e.charCodeAt(f++),r=e.charCodeAt(f++),i=e.charCodeAt(f++),s=n>>2,o=(n&3)<<4|r>>4,u=(r&15)<<2|i>>6,a=i&63,isNaN(r)?u=a=64:isNaN(i)&&(a=64),t=t+_keyStr.charAt(s)+_keyStr.charAt(o)+_keyStr.charAt(u)+_keyStr.charAt(a);return t},this.decode=function(e){var t="",n,r,i,s,o,u,a,f=0;e=e.replace(/[^A-Za-z0-9\+\/\=]/g,"");while(f<e.length)s=_keyStr.indexOf(e.charAt(f++)),o=_keyStr.indexOf(e.charAt(f++)),u=_keyStr.indexOf(e.charAt(f++)),a=_keyStr.indexOf(e.charAt(f++)),n=s<<2|o>>4,r=(o&15)<<4|u>>2,i=(u&3)<<6|a,t+=String.fromCharCode(n),u!=64&&(t+=String.fromCharCode(r)),a!=64&&(t+=String.fromCharCode(i));return t=_utf8_decode(t),t},_utf8_encode=function(e){e=e.replace(/\r\n/g,"\n");var t="";for(var n=0;n<e.length;n++){var r=e.charCodeAt(n);r<128?t+=String.fromCharCode(r):r>127&&r<2048?(t+=String.fromCharCode(r>>6|192),t+=String.fromCharCode(r&63|128)):(t+=String.fromCharCode(r>>12|224),t+=String.fromCharCode(r>>6&63|128),t+=String.fromCharCode(r&63|128))}return t},_utf8_decode=function(e){var t="",n=0,r=c1=c2=0;while(n<e.length)r=e.charCodeAt(n),r<128?(t+=String.fromCharCode(r),n++):r>191&&r<224?(c2=e.charCodeAt(n+1),t+=String.fromCharCode((r&31)<<6|c2&63),n+=2):(c2=e.charCodeAt(n+1),c3=e.charCodeAt(n+2),t+=String.fromCharCode((r&15)<<12|(c2&63)<<6|c3&63),n+=3);return t}}typeof define=="function"?define("lib/jquery/base64/base64",[],function(){return e}):typeof exports!="undefined"?module.exports=e:this.Base64=e}(),define("config/regular",[],function(){return{user_VARS:{email:/^[a-z0-9]([a-z0-9\\.]*[-_]{0,4}?[a-z0-9\\.]+)*@([a-z0-9]*[-_]?[a-z0-9]+)+([\.][\w_-]+){1,5}$/i,phone:/^1\d{10}$/,username:/^[_a-zA-Z][_0-9a-zA-Z-]{3,19}$/i,password:/^(?:(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])(?=.*[^A-Za-z0-9])|(?=.*[A-Z])(?=.*[a-z])(?=.*[0-9])|(?=.*[A-Z])(?=.*[a-z])(?=.*[^A-Za-z0-9])|(?=.*[A-Z])(?=.*[0-9])(?=.*[^A-Za-z0-9])|(?=.*[a-z])(?=.*[0-9])(?=.*[^A-Za-z0-9])|(?=.*[A-Z])(?=.*[a-z])|(?=.*[A-Z])(?=.*[0-9])|(?=.*[A-Z])(?=.*[^A-Za-z0-9])|(?=.*[a-z])(?=.*[0-9])|(?=.*[a-z])(?=.*[^A-Za-z0-9])|(?=.*[0-9])(?=.*[^A-Za-z0-9])).{6,}/,Chinese:/[\u4E00-\u9FA5]/,captcha:/^\d{4,6}$/,emailform:/^[\w-]+(\.[\w-]+)*@[\w-]+(\.[\w-]+)+$/},number_VARS:{money:"^[0-9]+[.][0-9]{0,3}$",number:/^[1][3][0-9]{9}$/,pint:/^[0-9]\d*$/,limit:/^[0-9]{2}$/,isnull:"^[ ]+$"},urlformat:/^((http|https):\/\/)((\w+):?(\w+)?@)?([^\/\?:]+):?(\d+)?(\/?[^\?#]+)?\??([^#]+)?#?(\w*)/,date:/^(\d{4})(-|\/|\.)(\d{1,2})\2(\d{1,2})$/,ascii:/^[\\x00-\\xFF]+$/,zipcode:/^\d{6}$/i,picture:/(.*)\\.(jpg|bmp|gif|ico|pcx|jpeg|tif|png|raw|tga)(\s|\?|$)/i,qq:/^[1-9][0-9]{4,20}$/}}),define("config/item_validation",["lib/jquery/1.11.1/jquery-1.11.1","config/regular"],function(e,t){var n=t.user_VARS,r=t.number_VARS;return{is_package:function(e,t){var n=$(".V_"+e);return n.length>0?!1:!0},is_choose:function(e,t){var n=$(".V_"+e);return n.length>0?!1:!0},is_select:function(e,t){var n=$(".V_"+e);return t.children(".select").length<1?(t.addClass("V_"+e),!1):!0},is_null:function(e){if(e=="")return!0;var t=r.isnull,n=new RegExp(t);return n.test(e)},checkMobile:function(e){var t=n.phone,r=new RegExp(t);return r.test(e)?!0:!1},isEmail:function(e){var t=n.email;return t.test(e)?!0:!1},isMoney:function(e){var t=e.indexOf("."),n=e.length-t-1;return e=Number(e),isNaN(e)||e<0||t>=0&&n>2?!1:!0},checkEmail:function(e){var t=n.emailform;return t.test(e)?!0:!1}}}),define("config/errorMsg",[],function(){return{username:{0:"*期望价格不能为空",1:"*价格格式不正确",2:"*期望价格要小于当前的价格",3:"*邮箱格式不正确",4:"*手机号格式不正确",5:"*邮箱/手机号至少填一个",6:"有效",7:"*邮箱地址不能为空",8:"*手机号不能为空",9:"*验证码不正确",10:"*手机验证码不正确"},toGoods:{0:"商品订阅到货通知成功！",2:"很抱歉，商品订阅到货通知失败！"},toPrice:{0:"商品订阅降价通知成功！",2:"很抱歉，商品订阅降价通知失败！"},collect:{0:"成功加入收藏夹！",1:"商品已收藏！",2:"收藏商品失败！",3:"抱歉，您今天收藏的商品数量已达到每天收藏上限！",4:"抱歉，您收藏的商品数量已达到总收藏上限！",5:"已收藏"},reservation:{0:"恭喜您预约成功，我们会以短信的方式通知您抢购时间。",1:"恭喜您预约成功。",2:"您已经预约过了，无需重复预约。",3:"对不起预约失效，已过了预约时效。",4:"您不符合购买条件，该商品需要提前预约才能购买。",5:"下手慢了哦，商品已被抢走。"},preSale:{0:"下手慢了哦，商品已被抢走。",1:"已经过了预定时效"},addCoupon:{1:"恭喜您优惠券领取成功！",8:"很抱歉，此优惠券领取已达到上限！",0:"领取失败,"},password:{"-1":"密码格式不正确,请重新输入","-2":"密码过于简单。密码必须为大小写字母、数字和特殊字符的其中三者的组合。","-3":"密码不可为空","-4":"密码不能为纯数字、纯英文、纯符号","-5":"密码格式错误,请输6~16个英文字符加数字组合"},password_repeat:{"-1":"两次输入的密码不相同"},captcha:{"-1":"验证码不正确","-3":"验证码不能为空","-4":"验证码获取失败","-5":"请接受服务条款"},register:{"-1":"注册成功","-2":"注册失败"},SMS:{"-1":"发送成功","-2":"发送失败"},forget:{"-1":"密码重置成功","-2":"密码重置失败"},wrongmsg:{"-1":"输入信息不合法",ge:"件",m_gifts:"请选择完整赠品规格",m_combina:"请选择完整组合商品规格",m_color:"请选择完整规格",m_size:"请选择完整规格",m_format:"请选择套餐",m_package:"请选择套餐",m_salepackage:"请选择商品规格",m_collocation:"请至少选择一种任意商品",m_noenough:"可卖量不足",m_purchase:"限购",thisShop:"此商品",youChoose:"您已购买过",noShop:"此商品为敏感商品",youCan:"只能加入",shopToCart:"商品到购物车",otherWay:"仅支持支付平台、网银支付，请半小时内付款成功，否则订单将自动取消",comma:",",fullstop:"。"},addshop:{0:"添加成功",1:"添加失败！"}}}),define("controller/www/item_tools",["lib/common","lib/template","widget/dialog-plus","lib/jquery/base64/base64","config/item_validation","config/errorMsg"],function(e,t,n,r,i,s){var o=null,u=s.wrongmsg;return e.temp=t,e.base64=new r,n.prototype.title=function(e){return this._$("title").html(e),this._$("header")[e?"show":"hide"](),this},{adaptation:function(t,n){typeof n.config[n.funName]=="undefined"?n.config[n.funName]={numFun:1,init:n.funName.split("_").length,data:{}}:n.config[n.funName].numFun++,n._data.code||e.extend(!0,n.config[n.funName].data,n._data.data),n.config[n.funName].numFun===n.config[n.funName].init&&(typeof t[n.funName]!="undefined"?t[n.funName](n.config[n.funName]):e.log("No Function! You must be create function in ajaxTemp!"))},setCookie:function(t,n){var r=new Date,i=new Date(r.getTime()+31536e6);e.cookie(t,n,{expires:i,path:"/",domain:www_domain_sub})},formatDate:function(e,t){var n=function(e){return e+="",e.replace(/^(\d)$/,"0$1")},r={yyyy:e.getFullYear(),yy:e.getFullYear().toString().substring(2),M:e.getMonth()+1,MM:n(e.getMonth()+1),d:e.getDate(),dd:n(e.getDate()),hh:e.getHours(),mm:e.getMinutes(),ss:e.getSeconds()};return t||(t="yyyy-MM-dd hh:mm:ss"),t.replace(/([a-z])(\1)*/ig,function(e){return r[e]})},is_itInType:function(t,n){if(t.it_in_type==3&&t.is_fresh_prod!=1){var r=e("#precisionHtml"),i="<strong>"+(n==0?"无货":"有货")+"</strong>";this.createHtml(r,i)}},show_temp:function(t){e(t).show()},is_empty_obj:function(e){for(var t in e)if(e.hasOwnProperty(t))return!0;return!1},de_code:function(t){return e.base64.decode(t)},en_code:function(t){return e.base64.encode(t)},close_dialog:function(){o.close().remove()},is_obj:function(e){var t=[],n=null;for(n in e){if(!e.hasOwnProperty(n))continue;t.push(n)}return t},comptime:function(e){var t=Date.parse(new Date),n=e.substring(0,10).split("-");n=n[1]+"/"+n[2]+"/"+n[0]+" "+e.substring(10,19);var r=t-Date.parse(n);return r},returnObj:function(e){return e.data.length?e.data:null},templates:function(t){var n={scriptID:"S_layer_body",htmlID:"content",datas:{}},r=e.extend(!0,n,t),i=r.htmlID,s=r.datas,o=r.scriptID,u=e.temp(o,s);document.getElementById(i).innerHTML=u},temp:function(e,t,n){this.templates({scriptID:e,htmlID:t,datas:n})},prompt:function(e,t,n){n.removeClass("V_"+e),n.removeClass("tips_color"),i["is_"+t](e,n)},promptHtml:function(t,n){var r=u["m_"+t],i;t=="purchase"&&(r+=e("#productNorm").find(".buyNum").val()+u.ge),e(n).html(r),clearTimeout(i),i=setTimeout(function(){e(n).html(""),e("#purchase").hide()},3e3),(t=="gifts"||"combina")&&e(".V_"+t).addClass("tips_color")},percentage:function(t){function l(e){var t=e,s=-(9400-t*94)+"px";n.css("background-position","0px	"+s),r.text(t),i.css("width",t+"%")}var n=e("#percentage"),r=e(".roundNum"),i=e("#goodNum"),s=e("#amidNum"),o=e(".amidNum"),u=e("#errNum"),a=e(".errNum"),f=null;t[0]==0&&t[1]==0&&t[2]==0?l(100):t[0]==0?n.css("background-position","0px -9306px"):l(t[0]),s.css("width",t[1]+"%"),o.text(t[1]),u.css("width",t[2]+"%"),a.text(t[2])},dialogs:function(t,r,i,s){var u={fixed:!0,width:"450px",height:"289px",title:"温馨提示",content:document.getElementById(t),cancelValue:"关闭",quickClose:!0,opacity:.4},a=e.extend(!0,u,r),f=n(a);f.showModal(),i&&setTimeout(function(){f.close().remove()},5e3),typeof arguments[3]=="function"&&arguments[3](),o=f;return},custom:function(t){var n=e(t),r=e(".small-layer"),i=n.hasClass("J_tie_in")?r.height()+20:-10,s=n.offset(),o=n.width()/2-10,u=r.find(".small-layer-button");r.css({position:"absolute",top:s.top-i,left:s.left-r.width()/2+o,"z-index":10}).show(),u.css("padding-left",r.width()/2-57)},createHtml:function(e,t){e.html(t)},addData:function(e,t,n){e.attr(t,n)},isClass:function(e,t){return e.hasClass(t)?!0:!1},createURL:function(e){location.replace(detail_url+c_item+"/"+e)},js_strto_time:function(e,t){var n=(new Date).getTime(),r=e==""?"":(new Date(Date.parse(e.replace(/-/g,"/")))).getTime(),i=(new Date(Date.parse(t.replace(/-/g,"/")))).getTime(),s=e==""||n-r>0?(i-n)/1e3:(i-r)/1e3,o=parseInt(s/86400),u=s-o*24*60*60,a=parseInt(u/3600),f=s-o*24*60*60-a*60*60,l=parseInt(f/60),c=s-o*24*60*60-a*60*60-l*60;return[o,u,s]},strto_time:function(e,t,n){n.hide();var r=setInterval(function(){e>0?t.show().html(" <span> "+e-- +"s</span>"+"重新发送"):(t.hide(),n.show(),clearInterval(r))},1e3)},indexOf_num:function(e){var t=0,n=e.toString();return n.indexOf(".")==-1?t=e:t=n.substring(0,n.indexOf(".")+3),t},changeTwoDecimal:function(e){var t=parseFloat(e);if(isNaN(t))return!1;var t=Math.round(e*100)/100;return t},animateFun:function(t,n,r){e("html,body").stop(!0,!0).animate(t,n,typeof arguments[2]=="function"?arguments[2]():function(){})},salepackageHtml:function(e,t,n,r,i){var s=0,o=r[i.tabClas+"mprice"+n],u=null;for(var a=0;a<o.length;a++)typeof o[a]!="undefined"&&typeof o[a]=="number"&&(s+=o[a]);u=s-r[i.tabClas+"sm_price"][n],u>0?(this.createHtml(e.eq(1),this.changeTwoDecimal(u)),t.show()):t.hide()},changeAlear:function(t,n,r){var i=e("#"+t),s=i.find("i"),o=i.find(".conect-title").children("span");switch(n){case 0:s.removeClass().addClass("colect-icon"),o.html(r);break;case 1:s.removeClass().addClass("colect-wram"),o.html(r);break;case 2:s.removeClass().addClass("colect-fail"),o.html(r)}},saleCountTime:function(e,t){function u(e){var n=e;return t>3&&(n=String(e).length>1?e:"0"+e),n}var n="";if(!e.length)return;var r=e.attr("data-time")*1e3,i=new Date,s=i.getTime()-0,o=setInterval(function(){var r=new Date,i=e.attr("data-time")*1e3-r.getTime()+s,a=u(Math.floor(i/864e5)),f=u(Math.floor(i/36e5)%24),l=u(Math.floor(i/36e5)),c=u(Math.floor(i/6e4)%60),h=u(Math.floor(i/1e3)%60),p=u(Math.floor(c*60));if(a>=0){if(a>0&&t<3)n="<span>仅剩：</span>"+a+" 天 ";else switch(t){case 0:n="仅剩<strong>"+f+"</strong>"+"时"+"<strong>"+c+"</strong>"+"分"+"<strong>"+h+"</strong>"+"秒";break;case 1:n="<span> "+f+" </span>"+"时"+"<span> "+c+" </span> "+"分"+" <span> "+h+" </span>"+"秒";break;case 2:n=" <span> "+p+"s</span>"+"重新发送";break;case 3:n=a+" 天 "+"<span> "+f+" </span>"+"时"+"<span> "+c+" </span> "+"分"+" <span> "+h+" </span>"+"秒";break;case 4:n="<span>"+a+"</span>"+"天"+"<span class='marginL9'>"+f+"</span>"+"时"+"<span class='marginL8'>"+c+"</span>"+"分"+"<span class='marginL9'>"+h+"</span>"+"秒";break;case 5:n="<span>"+f+"</span>"+"时"+"<span class='marginL9'>"+c+"</span>"+"分"+"<span class='marginL8'>"+h+"</span>"+"秒";break;case 6:n=l+":"+c+":"+h;break;case 7:n=a+"天"+f+"小时";break;case 8:n=f+"小时"+c+"分"+h+"秒"}e.html(n)}else if(t==3||t==1)clearInterval(o),location.reload()},100)},init_salepackage:function(t,n){var r=this,i=e(".salepackage"),s=e(".J_salepackage"),o=e(".package_index"),u=s.children().eq(n.J_tie_index).children("li:not('.package-add')").length,a=e(".salepackage").parent().children().eq(n.J_tie_index),f=s.next().find(".fn-rmb-num"),l=s.next().find(".total-save");n.tabClas="salepackage",e(".package-body").addClass("w645"),u>4&&s.css("overflow-x","scroll"),e.each(o.find("a:not('.hide')"),function(i,o){e(o).text("套装"+(i+1));if(!i){var u=e(o).parent().index(),c=Number(t[n.tabClas+"sm_price"][u]);e(o).addClass("cur").parent().css("background","none"),t.data.packageIndex=e(o).attr("data-index"),s.children().hide(),s.children().eq(u).show(),a.find(".V_salepackage").length>0?l.hide():r.salepackageHtml(f,l,u,t,n),r.createHtml(f.eq(0),c)}}),e.each(i,function(t,n){var r=e(this),i=r.children("li:not('.package-add')"),s=r.children("li[class='package-add']"),o=i.length,u=i.first().outerWidth(!0),a=s.length,f=s.first().outerWidth(!0);r.css("width",u*o+f*a)})},init_collocation:function(t,n){var r=e(".product-article"),i=e(".collocation"),s=i.children("li:not('.package-add')"),o=i.children("li[class='package-add']"),u=s.length,a=s.first().outerWidth(!0),f=o.length,l=o.first().outerWidth(!0);i.css("width",a*u+l*f),i.children().eq(i.children().length-1).remove(),u>3&&e(".J_collocation").css("overflow-x","scroll"),e(document).scrollTop()>=r.offset().top&&(r.find(".J_tabFixed").addClass("fixed"),e(".addshop-tab").show()),n.tabClas="collocation",t.data.packageIndex=0,e(".package-hide").show(),e(".package-body").addClass("w484")},is_spec:function(t,n,r,i,s,o){var u=i!=0?n+r:n,a=t.spec,f=t.sku_seq,l={};t.link=o.base.link+"/";if(typeof a!="undefined"&&t.is_spec){t.specLength=1;for(var c in t)c==="spec"&&(a.selectColor=t.color,a.selectSize=t.size,a.sm_seq=f+"_"+s,l[f+"_"+s]=a);a.color.length>1||a.size.length>1?(t.exper="V_"+n,t.color_size_num=1):(o.data[u][s]=o.skuSeq_list[f].sku_seq,t.color_size_sku=o.skuSeq_list[f].sku_seq,t.color_size_num=0)}else o.data[u][s]=o.skuSeq_list[f].sku_seq,t.color_size_sku=o.skuSeq_list[f].sku_seq,t.specLength=0;n=="collocation"&&(o.data[u].length=0),e.extend(!0,o,l)},set_qty:function(e,t,n,r){var i=!1,s={dis:!1,display_sm:null},o=e.color,u=e.size;for(var a in o){if(!o.hasOwnProperty(a))continue;var f=o[a].seq,l=o[a].size,c=o[a].size_seq,h=0;if(typeof l!="undefined"&&l.length)for(var p in l){if(!l.hasOwnProperty(p))continue;for(var d in l[p]){if(!l[p].hasOwnProperty(d))continue;var v=r.skuSeq_list[r.spec_dict[f+"_"+this.en_code(d)].sku_seq],m=v.is_delivery;t==1&&v.sku_status=="0"?(l[p][d]=0,c[p][d]=0):(h=1,t==1&&v.is_pre_order==1?(l[p][d]=v.pre_ava_qty,c[p][d]=v.pre_ava_qty):(l[p][d]=v.qty,c[p][d]=v.qty)),l[p][d]>0&&(m==1&&n==1||n==0)&&(o[a].status=1,s.dis=!0,s.display_sm={sku_seq:v.sku_seq,pic:o[a].pic,pic_36x36:o[a].pic_36x36,pic_120x120:o[a].pic_120x120})}}else{var v=r.skuSeq_list[r.spec_dict[f+"_"].sku_seq],m=v.is_delivery;h=v.sku_status,v.qty>0&&(n==1&&m==1||n==0)&&(o[a].status=1,s.dis=!0,s.display_sm={sku_seq:v.sku_seq,pic:o[a].pic,pic_36x36:o[a].pic_36x36,pic_120x120:o[a].pic_120x120})}t==1&&(o[a].is_display=parseInt(h))}if(typeof u!="undefined"&&u.length)for(var a in u){if(!u.hasOwnProperty(a))continue;var f=u[a].color,l=u[a].text,g=u[a].color_seq,h=0;for(var p in f){if(!f.hasOwnProperty(p))continue;for(var d in f[p]){if(!f[p].hasOwnProperty(d))continue;var v=r.skuSeq_list[r.spec_dict[d+"_"+this.en_code(l)].sku_seq],m=v.is_delivery;t==1&&v.sku_status=="0"?(f[p][d]=0,g[p][d]=0):(h=1,t==1&&v.is_pre_order==1?(f[p][d]=v.pre_ava_qty,g[p][d]=v.pre_ava_qty):(f[p][d]=v.qty,g[p][d]=f[p][d])),f[p][d]>0&&(n==1&&m==1||n==0)&&(u[a].status=1)}}t==1&&(u[a].is_display=parseInt(h))}return s},show_cart_btn:function(t){var n=t.skuSeq_list[t.base.sku_seq],r=e("#btnAddCart"),i=e(".addshop-create"),s=i.parent(".addshop-tab"),o=n.show_special_data,u=n.reservation_data,a=n.pre_sale_data,f="";if(n.sku_status==0)return!1;if(t.base.sm_group_type==5)t.base.mobile_packages_delivery?n.qty?(f="btn-mobile flyShop",t.base.susptype=0):(f="btn-mobile-no",e("#btnAvailableInform").addClass("btn-tip").show(),t.base.susptype=0):(t.base.susptype=0,e(".beforebuy-txt").html("抱歉，当前区域不在配送范围内"));else if(n.sale_price_status==5){var l=n.reservation_data,c="",h=0,p="";switch(l.status){case 0:case 1:c="btn-appointment",p="立即预约",this.is_itInType(t.base,1),t.maxPercent>0&&btn_free.show();break;case 2:case 3:c="btn-appointment-no",p="预约结束";break;case 4:n.qty?(c="btn-appointment-rush",h=1,p="立即抢购",this.is_itInType(t.base,1),l.is_limit&&(e("#ssm_limit_label").show(),e("#tbuyNum").attr("data-maxnum",l.limit),e("#ssm_limit").html(l.limit)),t.maxPercent>0&&btn_free.show()):(c="btn-fastpay-no",p="抢购一空");break;case 5:c="btn-fastpay-no",p="抢购一空"}f=c,t.base.susptype=h,t.base.suspshop=p}else if(t.base.is_ingeral==1)f="btn-ent flyShop",t.base.susptype=1,t.base.suspshop="加入购物车",this.is_itInType(t.base,1),t.maxPercent>0&&btn_free.show();else if(n.sale_price_status==6&&this.comptime(a.start_date)>0&&this.comptime(a.end_date)<0)a.stockSurplus>0?(f="btn-fastpay",t.base.susptype=1,t.base.suspshop="立即支付",a.is_limit&&(e("#ssm_limit_label").show(),e("#tbuyNum").attr("data-maxnum",a.limitNum),e("#ssm_limit").html(a.limitNum)),t.maxPercent>0&&btn_free.show()):(f="btn-fastpay-no",t.base.susptype=0,t.base.suspshop="抢购一空"),this.is_itInType(t.base,a.stockSurplus);else{var d=1,v=t.skuSeq_list[t.base.sku_seq];if(t.base.is_orgi_item==1)d=v.qty>0?1:0;else if(t.base.is_orgi_item==2){var m=t.base.mult_one_sm_seq,g=t.base.mult_qty,y=t.skuSeq_list[m];Math.floor(y.qty/g)<=0&&(d=0)}else if(t.combina.data.length&&typeof t["combina"].data!="undefined")for(var b in t.combina.data){if(!t.combina.data.hasOwnProperty(b))continue;if(d==0)break;var w=t.combina.data[b].spec;if(typeof t["combina"].data[b].spec=="undefined"&&!t.combina.data[b].spec){var E=t.combina.data[b].sku_seq,y=t.skuSeq_list[E];if(y.qty>0){y.qty--;continue}d=0}else{var S=w.color,x=0;for(var T in S){if(!S.hasOwnProperty(T))continue;if(S[T].status==1){x=1;break}}d=x}}d==1?(n.is_reservation==1&&this.comptime(n.reservation.sell_start_date)>0&&this.comptime(n.reservation.sell_end_date)<0?(f="btn-appointment-rush",t.base.susptype=1,t.base.suspshop="立即抢购",e("#ssm_limit_label").show(),e("#tbuyNum").attr("data-maxnum",n.reservation.limit),e("#ssm_limit").html(n.reservation.limit)):n.sale_price_status==2||n.sale_price_status==3?o.ssm_limit_qty>0?(f="btn-rush flyShop",t.base.susptype=1,t.base.suspshop="立即抢购",e("#ssm_limit_label").show(),e("#ssm_limit").html(o.ssm_limit_qty),o.is_sell_over_limit==0&&e("#over_limit_label").show()):(o.is_sell!=0&&(e("#ssm_label").show(),e("#ssm_qty").html(o.ssm_rplus_qty),o.surplus_null==1&&e("#over_qty_label").show()),f="btn-ent flyShop",t.base.susptype=1,t.base.suspshop="加入购物车"):n.sale_price_status==4?o.ssm_limit_qty>0?(f="btn-ent flyShop",t.base.susptype=1,t.base.suspshop="加入购物车",e("#ssm_limit_label").show(),e("#ssm_limit").html(o.ssm_limit_qty),o.is_sell_over_limit==0&&e("#over_limit_label").show()):(f="btn-ent flyShop",t.base.susptype=1,t.base.suspshop="加入购物车"):(f="btn-ent flyShop",t.base.susptype=1,t.base.suspshop="加入购物车"),t.maxPercent>0&&btn_free.show()):(n.is_reservation==1&&this.comptime(n.reservation.sell_start_date)>0&&this.comptime(n.reservation.sell_end_date)<0&&(t.base.suspshop="抢购一空"),f="btn-ent-no",e(".salepackage-btn").addClass("ui-button-90-no"),e(".salepackage-btn").removeClass("ui-button-90"),e(".salepackage-btn").removeClass("salepackage-btn"),e(".collocation-btn").addClass("ui-button-90-no"),e(".collocation-btn").removeClass("ui-button-90"),e(".collocation-btn").removeClass("collocation-btn"),e("#btnAvailableInform").addClass("btn-tip").show(),t.base.susptype=0),this.is_itInType(t.base,d)}loadDone=!0,typeof window.callPhantom=="function"&&window.callPhantom(),this.burying_point(t,f),n.sku_status=="1"&&(r.addClass(f),r.show(),this.temp("S_addshop_tab","J_addshop_tab",t.base))},burying_point:function(t,n){var r=[],i=t.skuSeq_list[t.base.sku_seq],s=i.sale_price;e(".breadcrumb a:lt("+e(".breadcrumb a").size()+")").each(function(){var t=e(this).attr("href"),n=e(this).text(),i=t.substr(t.lastIndexOf+1);r.push({cate_id:i,cate_name:n})}),idigger&&idigger.init({type:"product",pro_name:t.base.sm_name,pro_id:t.base.sku_seq,cate_id:r.length>0?r[r.length-1].cate_id:"",cate_name:r.length>0?r[r.length-1].cate_name:"",pro_price:s,pro_url:window.location.href,pro_img_url:e(".product-img img:eq(0)").attr("src"),one_cate:r.length>0?r[0].cate_name:"",two_cate:r.length>1?r[1].cate_name:"",three_cate:r.length>2?r[2].cate_name:"",four_cate:r.length>3?r[3].cate_name:"",brand_id:"",brand_name:"",pro_num:n.indexOf("flyShop")>-1?1:0,pro_net_price:t.base.it_mprice,pro_col_num:"",pro_off_time:t.base.stauts,pro_desc:""})}}}),define("controller/www/item_comment",["lib/common","controller/www/item_tools"],function(e,t){var n=function(n){var r=e("#comment"),i=n.base,s=i.sm_seq,o=i.mainshop,u=i.is_orgi_item==0?i.sm_seq:i.mi_spec_seq,a=i.spu_seq,f=r.find(".fn-comment-list .fn-mt"),l=e(".fn-st-comment-mask"),c=e(".fn-comment-not"),h=e(".fn-page-css-1"),p=null,d=0,v=4,m=0,g={total_page:10,current_page:1,boundary:7,front_range:1,mid_range:5,rear_range:1,page_size:10,type:0},y=function(){b(),S()},b=function(){var n=g.current_page,i=g.type;e.ajax({url:detail_url+c_item+"/getProductCommentVo?goodsId="+a+"&v="+Date.parse(new Date),dataType:"jsonp",success:function(n){if(n.code==0){var i=n.data,s=i.impression,o=i.goodCommentCount,u=i.goodCommentRate,a=i.normalCommentCount,f=i.normalCommentRate,l=i.badCommentCount,c=i.badCommentRate,h=i.addCommentCount,d=i.commentPicCount,v=i.replyCount,m=i.defaultComment,g=i.commentUserNum,y=o+a+l;r.find("[data-user-count]").html(g);var b=parseInt(y==0?0:a*100/y),w=parseInt(y==0?0:l*100/y),S=100-b-w;t.percentage([S,b,w]),e("#tabInner .total_comment").html(y),r.find("[data-good-comment-pre]").html(u),r.find("[data-good-comment]").html(o),r.find("[data-good-bar]").width(S),r.find("[data-middle-comment-pre]").html(f),r.find("[data-middle-comment]").html(a),r.find("[data-middle-bar]").width(b),r.find("[data-low-comment-pre]").html(c),r.find("[data-low-comment]").html(l),r.find("[data-low-bar]").width(w),r.find("[data-totel-comment]").html(y),r.find("[data-se-comment]").html(h),r.find("[data-replay-comment]").html(v),r.find("[data-image-comment]").html(d),p=[y,o,a,l,h,v,d];for(var x=0;x<s.length;x++)e(".fn-comment-yun").append("<li>"+s[x]+"</li>");E()}else e.log(n.msg)},error:function(t){e.log(JSON.stringify(t))}})},w=function(){var t=g.type,n=0;e(".fn-mc-bk").remove(),c.css("display","block"),h.css("display","none");switch(t){case 0:n=p[0];break;case 1:n=p[1];break;case 2:n=p[2];break;case 3:n=p[3];break;case 4:n=p[4];break;case 5:n=p[5];break;case 6:n=p[6]}g.total_page=Math.ceil(n/g.page_size),t==0&&n==0?c.html("暂无商品评价！只有购买过该商品的用户才能进行评价哦！"):t==1&&n==0?c.html("暂无好评！"):t==2&&n==0?c.html("暂无中评！"):t==3&&n==0?c.html("暂无差评！"):t==4&&n==0?c.html("暂无追评！"):t==5&&n==0?c.html("暂无回复！"):t==6&&n==0?c.html("暂无晒图！"):_()},E=function(){var n=g.current_page,r=g.type,i=e("#loadingBox");e.ajax({url:detail_url+c_item+"/getCommentsByStarForAll?goodsId="+a+"&goodsType=1&getType="+g.type+"&curPage="+g.current_page+"&pageSize="+g.page_size+"&v="+Date.parse(new Date),dataType:"jsonp",success:function(n){if(n.code==0){var r=n.data,s=r.dataList;w();if(typeof s!="undefined"){for(var o=0;o<s.length;o++){var u=[];s[o].productMark!=""&&(u=s[o].productMark.split(",")),e.extend(!0,s[o],{productMarkList:u,commentPicUrls:s[o].commentPicUrls==""?[]:s[o].commentPicUrls.split(";"),addComnentPicUrls:s[o].addComnentPicUrls==""?[]:s[o].addComnentPicUrls.split(";")})}c.css("display","none"),t.temp("S_show_comment","J_show_comment",r),L(s),h.css("display","block")}}else e.log(n.msg);e("#comment").show(),i.hide()},error:function(t){e.log(JSON.stringify(t))}})},S=function(){r.on("click",".fn-comment-photos li",x.showImages),r.on("click","a.view-btn",x.changeImages),r.on("click",".view-close",x.hideImages),r.on("click",".view-left",x.leftImages),r.on("click",".view-right",x.rightImages),r.on("click","[data-mask-show]",x.click_comment),l.on("click",x.hide_mask),r.on("click","a[data-comment-id]",x.praise_comment),r.on("click",".reply-sp",x.reply_comment),r.on("click",".fn-photos-list li",x.show_photos_list),r.on("click",".fn-photos-list a",x.click_slide_updown),r.on({mouseenter:function(){var t=e(this),n=t.parent(),r=n.next(),i=r.find("ul"),s=i.children("li").length,o=i.children(".vselect"),u=o.index(),a=t.children(".view-navleft"),f=t.children(".view-navright");if(s==1)return!1;t.children(".view-btn").show(),u?u==s-1&&(a.show(),f.hide()):(a.hide(),f.show()),t.find(".add_img").html(u+1),t.find(".current_img").html(u+1)},mouseleave:function(){var t=e(this);t.children(".view-btn").hide()},click:function(){var t=e(this),n=t.parents(".fn-photos-view");n.hide(200)}},".fn-photos-show"),e("li[data-comment-type]",f).hover(function(){var t=e(this);e(".fn-mt-bor",f).css("left",t.position().left)},function(){var t=e(".on",f);e(".fn-mt-bor",f).css("left",t.position().left)}).on("click",function(){e("li",f).removeClass("on"),e(this).addClass("on");var t=e(this).data("comment-type");g.current_page=1,g.type=t,E()})},x={showImages:function(t){var n=e(t.currentTarget),r=n.index(),i=n.parent(),s=n.parent().next(".fn-photos-view"),o=s.attr("data-local"),u=s.children(".fn-photos-area"),a=s.children(".fn-photos-list").find("ul"),f=a.children("li"),l=f.eq(r),c=u.find("a"),h=u.find(".view-navleft"),p=u.find(".view-navright"),v=n.children("img").attr("src"),m=i.children().length,g=n.prev().length,y=n.next().length;l.addClass("vselect").siblings().removeClass("vselect"),s.show(200),m==1?c.hide():(g?h.show():h.hide(),y?p.show():p.hide()),u.find("img").attr("src",v),u.find(".add_img").html(r+1),u.find(".current_img").html(r+1),d=0,T(u.find("img"),0),k(a)},show_photos_list:function(){var t=e(this),n=t.index(),r=t.children("img").attr("src"),i=t.parent("ul"),s=t.parents(".fn-photos-view").attr("data-local"),o=t.parents(".fn-photos-list"),u=o.prev(".fn-photos-area"),a=u.find("img");return i.children().removeClass("vselect"),t.addClass("vselect"),a.attr("src",r),d=0,T(a,0),m=n,!1},changeImages:function(t){var n=e(t.currentTarget),r=n.parents(".fn-photos-area"),i=n.parents(".fn-photos-view").attr("data-local"),s=r.next(".fn-photos-list").find("ul"),o=s.children("li"),u=o.eq(0).outerHeight(!0),a=s.children("li").length,f=Math.ceil(a/v),l=s.children(".vselect").index(),c=o.eq(l),h=u*v;if(a==1)return;n.hasClass("view-navleft")?(l--,l<=0?n.hide().next().show():n.show().next().show(),m!==0&&(m--,C(s,"-"+l*u))):(l++,l>=a-1?n.hide().prev().show():n.show().prev().show(),m<a-1&&(C(s,"-"+l*u),m++));var p=s.children("li").eq(l).children().attr("src");return s.children("li").eq(l).addClass("vselect").siblings().removeClass("vselect"),n.siblings("img").attr("src",p),d=0,r.find(".add_img").html(l+1),r.find(".current_img").html(l+1),T(n.siblings("img"),0),!1},hideImages:function(t){var n=e(t.currentTarget),r=n.parents(".fn-photos-view"),i=r.prev(".fn-comment-photos").children("li");r.hide(200),i.removeClass("vselect")},leftImages:function(t){var n=e(t.currentTarget),r=n.parents(".fn-photos-view"),i=r.attr("data-local"),s=r.find(".fn-photos-show").children("img"),o=0;return o=d-90,o===-90&&(o=270),T(s,o),d=o,!1},rightImages:function(t){var n=e(t.currentTarget),r=n.parents(".fn-photos-view"),i=r.attr("data-local"),s=r.find(".fn-photos-show").children("img"),o=0;return o=d+90,T(s,o),o===270&&(o=-90),d=o,!1},click_slide_updown:function(){var t=e(this),n=t.parent(),r=n.prev(".fn-photos-area"),i=n.find("ul"),s=i.children(),o=s.eq(0).outerHeight(!0),u=i.children().length,a=Math.ceil(u/v),f=o*v,l=i.find(".vselect").index();m=l,t.hasClass("fn-photos-up")?m!==0&&(m--,N(s,r),C(i,"-"+(l-1)*o)):t.hasClass("fn-photos-down")&&m<u-1&&(C(i,"-"+l*o),m++,N(s,r))},click_comment:function(){var t=e(this),n=t.data("mask-show");e.ajax({url:detail_url+c_item+"/check_login?v="+Date.parse(new Date),dataType:"jsonp",jsonp:"callback",success:function(e){e.code!==0?fnDialog():window.location.href="http://my"+www_domain_sub+"/comment/myCommentView"}})},hide_mask:function(t){if(!e.contains(this,t.target)||e(t.target).data("mask-hide")=="1")e(this).stop(!0,!0).fadeOut();else if(!e.contains(this,t.target)||e(t.target).data("mask-hide")=="2")window.location.href="http://my"+www_domain_sub+"/comment/myCommentView"},praise_comment:function(){var t=e(this),n=t.data("comment-id")+"";typeof e.cookie(n)=="undefined"&&e.ajax({url:detail_url+c_item+"/praise_comment?commentId="+n+"&v="+Date.parse(new Date),dataType:"jsonp",success:function(r){r.code==0?(A(t,r.data),e.cookie(n,r.data)):(r.code==-1501||r.code==705)&&fnDialog()}})},reply_comment:function(){var t='<div class="fn-comment-reply-from" id="reply-from"><h3>回复用户B:</h3><input type="text"> <button value="">回复</button></div>',n='<span id="reply-sp">[回复]</span>',r=e("#reply-from"),i=e("#reply-sp"),s=e(this),o=s,u=s.data();for(var a=0;a<=u.reply;a++)o=o.parent();e(r,o).length||r.slideUp(100,function(){o.append(t),e("#reply-from").slideDown(100).find("input").val("")}).find("h3").html("回复"+u.replyN+"：")}},T=function(e,t){var n={};n.angle=((n.angle==undefined?0:n.angle)+t)%360,n.src=e.attr("src"),n.height=e.height(),n.width=e.width();if(n.angle>=0)var r=Math.PI*n.angle/180;else var r=Math.PI*(360+n.angle)/180;var i=Math.round(Math.cos(r)*1e3)/1e3,s=Math.round(Math.sin(r)*1e3)/1e3;navigator.appName!="Microsoft Internet Explorer"||navigator.appVersion.match(/8./i)!="8."&&navigator.appVersion.match(/8./i)!="7."?e.css("transform","rotate("+t+"deg)"):e.css({width:n.width,height:n.height,filter:"progid:DXImageTransform.Microsoft.Matrix(M11="+i+",M12="+ -s+",M21="+s+",M22="+i+",SizingMethod='auto expand')"})},N=function(e,t){e.removeClass("vselect");var n=e.eq(m),r=n.children("img"),i=r.attr("src"),s=t.find("img");n.addClass("vselect"),s.attr("src",i),d=0,T(s,0)},C=function(e,t){e.css("margin-top",t+"px")},k=function(e){var t=e,n=t.children("li").length,r=t.children("li").eq(0).outerHeight(!0),i=v*r,s=r*n,o=Math.ceil(n/v),u=t.children(".vselect").index(),a=r*v;m=u,C(t,"-"+m*r)},L=function(t){for(var n=0;n<t.length;n++){var r=t[n].commentId,i=t[n].niceCount;typeof e.cookie(r+"")!="undefined"&&A(e('[data-comment-id="'+r+'"]'),i),O()}},A=function(t,n){var r=t.find("[data-io]"),i=e("<span>"+n+"</span>"),s=e("<span>"+r.data("io")+"</span>");i.css({position:"absolute",top:"-15px",right:"13px",opacity:"0",color:"#f22e00"}).animate({top:"0px",opacity:"1"},500,function(){i.remove(),r.data("io",n).html(r.data("io")).css("color","#f22e00")}),s.css({position:"absolute",top:"0px",right:"13px",opacity:"1",color:"#f22e00"}).animate({top:"15px",opacity:"0"},500),t.addClass("on").append([i,s]),r.css("color","#fff")},O=function(){e("#comment").find(".fn-comment-star").each(function(){var t=e(this),n=t.find("i");n.slice(0,t.data("star")).addClass("star-01"),n.slice(t.data("star"),n.length).addClass("star-02")})},M=function(){var e=g.total_page,t=g.boundary,n=g.front_range,r=g.mid_range,i=g.rear_range,s=g.current_page,o=[];s=s>e?e:s;if(e<=t)for(var u=1;u<=e;u++)o.push(u);else{var a=n,f=s-Math.ceil(parseFloat(r-1)/2),l=s+(r-1-Math.ceil((r-1)/2)),c=e-i+1;while(f<=1)f<1&&(l+=1),f+=1;while(l>=e)l>e&&(f-=1),l-=1;for(var u=1;u<=e;u++)if(u<=a||u>=f&&u<=l||u>=c)u-o[o.length-1]>1&&o.push("..."),o.push(u)}return o},_=function(){e(".pagintion").children().remove();var t=g.current_page,n=g.total_page;if(n<=1)return;var r="<ul>",i=M();if(t<=1)r+='<li class="pg-prev pg-off"><a href="javascript:void(0)"><i></i>上一页</a></li>';else{var s=t-1;r+='<li class="pg-prev" data-page-index='+s+'><a href="javascript:void(0)"><i></i>上一页</a></li>'}for(var o=0;o<i.length;o++){var u=i[o];u==t?r+='<li class="pg-on pg-index"  data-page-index='+u+'><a href="javascript:void(0)" class="on">'+u+"</a></li>":u=="..."?r+="<li>...</li>":r+="<li pg-index data-page-index="+u+'><a href="javascript:void(0)">'+u+"</a></li>"}if(t>=n)r+='<li class="pg-next pg-off"><a href="javascript:void(0)">下一页</a></li>';else{var a=t+1;r+='<li class="pg-next" data-page-index='+a+'><a href="javascript:void(0)">下一页</a></li>'}r+='<li class="pg-num-top">到第</li>',r+='<li class="pg-num"><input type="text" class="jump_index" ></li>',r+='<li class="pg-num-bot">页</li>',r+='<li class="pg-btn"><a href="javascript:void(0);" class="btn_jump">确定</a></li>',r+="</ul>",e(".pagintion").append(r),e(".pagintion").find("[data-page-index]").on("click",function(){e(this).data("page-index")!=g.current_page&&(g.current_page=e(this).data("page-index"),E())}),e(".pagintion").find(".btn_jump").on("click",function(){var t=/^\d*$/,r=e(".jump_index").val();t.test(r)&&parseInt(r)>=0&&parseInt(r)<=n&&parseInt(r)!=g.current_page?(g.current_page=parseInt(r),E()):e(".jump_index").val("")})};y()};return{main:n}}),define("widget/magnifier",["lib/common"],function(e){return e.fn.magnifier=function(t){function T(e){p.removeClass("active");var t=p.eq(e*d-d).addClass("active").find("img");E=t.attr("data-img"),S=t.attr("data-big"),r.children("img").attr("src",E),u.attr("src",S)}function N(e){h.stop(!0,!0).animate({marginLeft:e+"px"},"slow")}var n={magnifier:"magnifier",showAre:"show_big_img",spanID:"gao",showImg:"postion_img",scrollable:"scrollable",area_img:400,rollNum:4,seconds:300};t=e.extend(n,t);var r=e(this).children("."+t.magnifier),i=e(this).children("."+t.scrollable),s=e("#"+t.spanID),o=e("."+t.showAre),u=e("."+t.showImg),a=(o.width()/s.width()).toFixed(3),f=o.width()/s.width()*t.area_img,l=maxWidth=maxHeight=0,c=t.seconds,h=i.find("ul:eq(0)"),p=i.find("ul:eq(0)").children("li"),d=t.rollNum,v=i.find("li").length,m=i.find("li:eq(0)").outerWidth(!0),g=Math.ceil(v/d),y=d*m,b=1,w=d*m,E,S,x;o.css({left:r.position().left+r.outerWidth()+"px",top:r.position().top+"px"}),h.css({width:g*y+"px"}),E=h.children(".active").find("img").attr("data-img"),S=h.children(".active").find("img").attr("data-big"),u.css({width:f,height:f}),r.on({mouseover:function(e){l=s.height()/2,maxWidth=r.width()-s.width(),maxHeight=r.height()-s.height(),s.show(),o.show(),u.attr("src",S)},mousemove:function(t){t=t||window.event;var n=t.clientX+e(document).scrollLeft()-r.offset().left-l,i=t.clientY+e(document).scrollTop()-r.offset().top-l;n=n<0?0:n>maxWidth?maxWidth:n,i=i<0?0:i>maxHeight?maxHeight:i,s.css({left:n+"px",top:i+"px"}),u.css({marginLeft:"-"+(n==0?0:n)*a+"px",marginTop:"-"+(i==0?0:i)*a+"px"})},mouseout:function(e){s.hide(),o.hide(),u.removeAttr("src")}}),i.on("click","a",function(t){e(this).hasClass("next-left")?b!==1&&(e(this).parent().children(".next-right").removeClass("disabled"),b--,N(w-w*b),T(b),b===1&&e(this).addClass("disabled")):e(this).hasClass("next-right")&&(e(this).parent().children(".next-left").removeClass("disabled"),b<g&&(N("-"+w*b),b++,T(b),w*b===g*y&&e(this).addClass("disabled")))}),g==1?(i.children(".next-btn").addClass("disabled"),i.unbind()):i.children(".next-left").addClass("disabled"),i.on({mouseover:function(t){var n=e(this);x=window.setInterval(function(){E=n.find("img").attr("data-img"),S=n.find("img").attr("data-big"),p.removeClass("active"),n.addClass("active"),r.find("img").attr("src",E),u.attr("src",S)},c)},mouseout:function(e){clearInterval(x)}},"li")},e}),define("config/saleType",[],function(){return{0:"加入购物车",1:"立即预订",2:"立即抢购",3:"买立减",4:"售完补货中",5:"即将开卖",6:"预购结束",7:"已抢购一空",8:"修改",9:"普通",10:"特卖变价",11:"买立折",12:"一般变价"}}),define("config/dialogTitle",[],function(){return{1:"收藏单品",2:"到货通知",3:"降价通知",4:"填写预约信息",5:"温馨提示"}}),define("config/item_dialogs",["controller/www/item_tools","config/dialogTitle","widget/dialog-plus"],function(e,t,n){return{addCart:function(t,n){e.dialogs("addCartBox",{width:"450px",height:"auto"},!1,function(){e.changeAlear("addCartBox",t,n)})},addCoupon:function(t,n){e.dialogs("addCoupon-box",{width:"300px",height:"auto"},!0,function(){e.changeAlear("addCoupon-box",t,n)})},collect:function(n,r){e.dialogs("collect-box",{title:t[1]},!0,function(){e.changeAlear("collect-box",n,r)})},toGoods:function(){e.dialogs("togoods-box",{id:"addGift",width:"450px",height:"203px",title:t[2]},!1)},goGoodsEnd:function(r,i){e.dialogs("togoods-sub-box",{width:"450px",height:"238px",title:t[2],opacity:.2},!1,function(){n({id:"addGift"}).close(),e.changeAlear("togoods-sub-box",r,i)})},toPrice:function(){e.dialogs("toprice-box",{id:"zPrice",width:"450px",height:"248px",title:t[3]},!1)},toPriceEnd:function(r,i){e.dialogs("togoods-sub-box",{width:"450px",height:"238px",title:t[3]},!1,function(){n({id:"zPrice"}).close(),e.changeAlear("togoods-sub-box",r,i)})},chooseShop:function(t){e.custom(t)},toRese:function(){var n=t[4]+"<span class='colr666 fontSize12'>（提交后不可修改）</span>";e.dialogs("reservation-box",{id:"zRese",width:"450px",height:"auto",title:n},!1)},toReseEnd:function(r,i){e.dialogs("appointment-box",{width:"450px",height:"auto",title:t[5]},!1,function(){n({id:"zRese"}).close(),e.changeAlear("appointment-box",r,i)})},topreSale:function(t,n){e.dialogs("preSaleBox",{width:"450px",height:"auto"},!1,function(){e.changeAlear("preSaleBox",t,n)})},tohijacking:function(){e.dialogs("hijacking-box",{width:"300px",height:"auto"},!1)},checkareamap:function(t){e.dialogs("J_checkareamap_box",{width:"480px",height:"auto"},!1,function(){e.temp("S_checkareamap_box","J_checkareamap_box",{dis:!0,type:send_type,checkareamap:t})})}}}),define("controller/www/item_active",["widget/magnifier","config/item_config","controller/www/item_tools","config/regular","config/errorMsg","config/saleType","config/dialogTitle","config/item_validation","config/item_dialogs"],function($,_obj,tools,regular,errorMsg,saleType,dialogTitle,validation,dialogsFuns){var itemmutual=function(obj){var _base=obj.base,_sm_seq=_base.sku_seq,_dis_spec=obj.spec.dis,_mainshop=_base.mainshop,user_VARS=regular.user_VARS,number_VARS=regular.number_VARS,addshopMsg=errorMsg.addshop,usernameMsg=errorMsg.username,toGoodsMsg=errorMsg.toGoods,toPriceMsg=errorMsg.toPrice,collectMsg=errorMsg.collect,addCouponMsg=errorMsg.addCoupon,reservationMsg=errorMsg.reservation,preSaleMsg=errorMsg.preSale,exper_promotion=obj.verification,ajaxData=obj.data,init=function(){$("body").on("click",".J_chooseShop",statics.chooseShop),$(".package").on("click",".J_tie_in",statics.chooseShop),$(".small-layer").on("click",".small-layer-close",statics.layerClose),$(".small-layer").on("click",".small-layer-button a",statics.layerSure),$("body").on("click",'.tab-inner .tab-toggle:not(".addshop-tab")',statics.tab),$("#productNorm").on("click",".J_rush_click",statics.rushClick),$("body").on("click",".package_index a",statics.packageTab),$("#productNorm").on("click change",".selectCtrl li:not('.nosold')",statics.selectValue),$("#J_layer_body").on("click change",".selectBody li:not('.nosold')",statics.selectBody),$("body").on("click",".mins,.add",statics.addOrMinus),$("body").on("keyup",".buyNum",statics.changeCount),$("body").on("blur",".buyNum",statics.isCount),$("body").on("click",".J_collocation input[type='checkbox']",statics.addPrice),$("body").on("click",".go-shopping",statics.goshoping),$("body").on("click",".pie-see-user",statics.pieUser),$("body").on("click",".audit-btn",statics.auditfun),$(".prompt").on({mouseover:statics.ruleLocal,mouseout:statics.ruleLocalClose},".prompt_icon"),$("body").on("click",".feiniu_service",statics.feiniuService),$("body").on("click",".feiniu_top",statics.feiniuTop),$("body").on("click",".sim_norms",statics.sim_norms),$("body").on({mouseenter:statics.vipCodeshow,mouseleave:statics.vipCodehide},".J_vipCode"),$("body").on({mouseenter:statics.yanbaoShow,mouseleave:statics.yanbaoHide,click:statics.chooseYanbao},".M_yanbao li"),$("body").on("click",".yanbao-select dd a",statics.chooseAlert),$("body").on("click",".sale-tab li",statics.chooseSale),$("body").on({mouseenter:statics.huabeiShow,mouseleave:statics.huabeiHide},".M_huabei li:not(.no_hover)"),$("body").on({mouseover:statics.ruleHuabei,mouseout:statics.ruleHuabeiClose},".M_huabei .prompt_icon"),$("body").on("click",".ok-hijacking",statics.ok_hijacking),$("body").on("click",".fail-hijacking",statics.fail_hijacking),$("body").on("click",".change_area",statics.change_area),$("body").on("click",".close_area",statics.close_area),$("body").on("click",".flyShop",{func_name:"normalShop"},ajaxFuns.addshop),$("body").on("click",".addshop-btn",{func_name:"normalShop"},ajaxFuns.addshop),$("body").on("click",".salepackage-btn",{func_name:"salepackageShop"},ajaxFuns.addshop),$("body").on("click",".collocation-btn",{func_name:"collectionShop"},ajaxFuns.addshop),$("body").on("click","#btnAvailableInform",ajaxFuns.toGoods),$("body").on("click","#toprice",ajaxFuns.toPrice),$("body").on("click","#topriceSubmit",ajaxFuns.toPriceSubmit),$("body").on("click","#togoodsSubmit",ajaxFuns.toGoodsSubmit),$("body").on("click",".addCoupon",ajaxFuns.addCoupon),$("body").on("click","#collectLink",ajaxFuns.collect),$(".product-button").on("click",".btn-appointment,.btn-appointment-rush",{func_name:"reser_presale"},ajaxFuns.addshop),$(".product-button").on("click",".btn-fastpay",{func_name:"normalShop"},ajaxFuns.addshop),$("body").on("click","#reserSubmit",ajaxFuns.reserSubmit),$("body").on("click","#phone-verifi",ajaxFuns.getphoneVerifi),$("body").on("click","#input-verifi",ajaxFuns.returnVerifi),$("body").on("click",".J_ajax_sale",ajaxFuns.saleService),$("body").on("click",".btn-free",{func_name:"normalShop"},ajaxFuns.addshop),$(".tab-inner").on({mouseenter:function(){$(".addshop-create").parent().addClass("addshop-border"),$(".addshop-area").show()},mouseleave:function(){$(".addshop-area").hide(),$(".addshop-create").parent().removeClass("addshop-border")}},".addshop-tab"),$("#photoBody").magnifier({magnifier:"product-img",showAre:"big-pic",spanID:"J_cursor",scrollable:"product-small-img",seconds:600,rollNum:5}),$("img[data-original]").lazyload({placeholder:"",threshold:200,skip_invisible:!1}),show_collection(),show_mobile_top(0)},statics={layerSure:function(){var e=$(this),t=$(_obj.chooseShop),n=t.parents("div"),r=e.parents(".small-layer-body"),i=r.children(".small-select-color").children(".select").find("img").attr("src"),s=t.parent(),o=s.prevAll(".package-price").find("input[type = 'checkbox']"),u=r.children(),a=u.eq(1).children().length>0?a=2:a=1,f=r.find(".select"),l=t.prev(),c=t.parents("li"),h=c.find(".fn-rmb-num"),p=c.index(),d=t.parents("ul").children().eq(p),v=p-c.prevAll("li[class$='-add']").length,m="",g="",y=[],b=[];if(f.length==a){var w=c.data("v").split("_"),E=w[0],S=w[1];for(var x=0;x<a;x++)y[x]=$(f[x]).children("span").attr("data-id"),b[x]=$(f[x]).children("span").attr("data-text");a>1?g=y.join("_"):g=y+"_",m=obj.spec_dict[g].sku_seq,tools.prompt(E,S,c);if(n.hasClass("package-body")){var T=E!="collocation"?$(".detail-box").find(".package-tab .cur").parent().index():0;_obj.J_tie_index=T,E+=T,s.addClass("package-point")}tools.createHtml(l,"已选择："+b.join(" ")+" "),tools.createHtml(t,saleType[8]),tools.addData(t,"data-spec",g);if(t.parents("ul").hasClass("collocation")){var N=obj.skuSeq_list[m];tools.addData(o,"data-skuId",m),_obj.colloNum=Number(t.parent().prev().find(".buyNum").val()),createIndexArr(E,N.sale_price,v),o.prop("checked")?getColl(o,3,m):getColl(o,0,m)}else{tools.addData(t,"data-skuId",m),createIndexArr(E,m,v);if(t.parents("ul").hasClass("salepackage")){var C=$(".J_salepackage"),k=C.next().find(".fn-rmb-num"),L=C.next().find(".total-save"),A=obj.skuSeq_list[m],O=$(".salepackage").parent().children().eq(_obj.J_tie_index).find(".V_salepackage");d.find(".fn-rmb-num").html(obj.skuSeq_list[m].sm_price),obj[_obj.tabClas+"mprice"+_obj.J_tie_index][v]=A.fn_price,h.html(A.fn_price);if(O.length>0)L.hide();else{var M=0,_=obj[_obj.tabClas+"mprice"+_obj.J_tie_index],D=null;for(var x=0;x<_.length;x++)typeof _[x]!="undefined"&&(M+=Number(_[x]));D=M-obj[_obj.tabClas+"sm_price"][_obj.J_tie_index],D>0?(tools.createHtml(k.eq(1),tools.changeTwoDecimal(D)),L.show()):L.hide()}}}d.find("a:not('[class^=J_],[class^=total-]')").attr("href","").attr("href",detail_url+c_item+"/"+m),d.find("img").attr("src",i),$(".small-layer").hide()}else tools.promptHtml("size",".small-layer-error")},layerClose:function(){closeSome()},chooseShop:function(){var e=$(this).attr("data-id"),t=$(this).parents("li").index(),n=$(this).parents("div");_obj.chooseShop=this,n.hasClass("package-body")&&(t=$(this).parents("li").index()-$(this).parents("li").prevAll("li[class$='-add']").length);var r=obj[e+"_"+t];if(!$(this).attr("data-spec"))tools.temp("S_layer_body","J_layer_body",r);else{var i=$(this).attr("data-spec").split("_"),s={selectColor:i[0],selectSize:i[1]},o=$.extend(!0,r,s);tools.temp("S_layer_body","J_layer_body",o),alertChoose(r,"color","selectColor",$(".small-layer-body")),r["selectSize"]!=""&&r["selectSize"]!=null&&alertChoose(r,"size","selectSize",$(".small-layer-body"))}dialogsFuns.chooseShop(this)},selectValue:function(){var e=$(this),t=obj.spec.data.spec,n=e.parent(),r=$(".product-opt-info p"),i=n.data("v").split("_"),s=e.children("span"),o="",u=i[0],a=i[1],f=!1;tools.isClass(e,"select")?(e.removeClass("select"),f=!1):(n.children("li").removeClass("select"),e.addClass("select"),o=s.data("spec"),f=!0),selectLength(0,u,e,t,$("#J_color_format"),f),r.children(".M_"+u).html(o!=""?'"'+o+'"':""),tools.prompt(u,a,n)},selectBody:function(){var e=$(this),t=e.parents("ul"),n=e.children("span"),r=n.data("spec"),i=n.data("id"),s=t.hasClass("small-select-color")?"color":"size",o=!1;tools.isClass(e,"select")?(e.removeClass("select"),o=!1):(e.addClass("select").siblings().removeClass("select"),o=!0);if(typeof obj[r].size=="undefined"&&!obj[r].size.length)return!1;selectLength(1,s,e,obj[r],$("#J_layer_body"),o)},addOrMinus:function(e){var t=$(e.currentTarget),n=t.parents(".number"),r=t.siblings("input"),i=$("#numLast").attr("data-maxnum"),s=i!=""?parseInt(i):parseInt(r.val())+2,o=parseInt(r.val())+parseInt(t.attr("data-carnum"));closeSome(),o>0&&o<=s?(r.val(o),tools.isClass(t.parents("ul"),"collocation")&&colloerraler(t,o),o==1?n.find("a:eq(0)").addClass("mins no-mins"):o==s?n.find("a:eq(1)").addClass("add no-mins"):n.find("a").removeClass("no-mins"),judge_AS(t,o),collocation_AS(t,o),huabei_AS(o)):o>s&&(r.val(s),n.find("a:eq(0)").addClass("no-mins"))},changeCount:function(e){var t=$(this),n=t.parents(".number"),r=$("#numLast").attr("data-maxnum"),i=t.val(),s=parseInt(i),o=r!=undefined?parseInt(r):parseInt(i)+2;closeSome(),e.keyCode!="8"?i.match(number_VARS.pint)&&s>0?i.match(number_VARS.limit)?(n.find("button").removeClass("icon-minus-gray icon-add-gray"),s>o?(i=o,n.find("button").eq(1).hasClass("add icon-add-gray")):s<=0?(i=1,n.find("a").eq(0).hasClass("minus icon-minus-gray")):s==o&&n.find("a").eq(1).hasClass("add icon-add-gray"),t.val(i),tools.isClass(t.parents("ul"),"collocation")&&colloerraler(t,i),n.next().parents(".product-number").next().find(".beforebuy-txt").empty()):i.match(number_VARS.pint)?i.length>2&&t.val(i.substr(0,2)):t.val(1):t.val(1):i.length==0&&t.val(1)},isCount:function(){var e=$(this),t=e.val(),n=parseInt(t),r=$("#numLast").attr("data-maxnum");closeSome(),t.length>=2&&e.val(t.substr(0,2)),tools.isClass(e.parents("ul"),"collocation")&&colloerraler(e,n),judge_AS(e,n),collocation_AS(e,n),huabei_AS(n)},packageTab:function(){var e=$(this),t=e.attr("data-index"),n=$(".J_salepackage"),r=n.next().find(".fn-rmb-num"),i=e.parents("ul"),s=e.parent().index(),o=Number(obj[_obj.tabClas+"sm_price"][s]),u=n.children().eq(s),a=n.next().find(".total-save"),f=u.children("li:not('.package-add')").length;ajaxData.packageIndex=t,_obj.J_tie_index=s,$(".total-title").html("优惠"+e.text()),closeSome(),i.find("a").removeClass("cur"),n.children().hide(),e.addClass("cur"),u.show(),u.find(".V_"+_obj.tabClas).length>0?a.hide():tools.salepackageHtml(r,a,_obj.J_tie_index,obj,_obj),tools.createHtml(r.eq(0),o),f>3?n.css("overflow-x","scroll"):n.css("overflow-x","hidden")},tab:function(){var e=$(this),t=e.parent(),n=e.parents(".detail-tab").next().children(),r="tab-cur",i=$(".audit"),s=e.index();closeSome(),s==0?i.show():i.hide(),e.attr("class").indexOf("tab_")>-1&&(_obj.tabClas=e.attr("class").split("tab_")[1],$(".package-hide").hide(),$(".package-body").removeClass("w484").addClass("w645"),_obj.tabClas!="salepackage"?(ajaxData.packageIndex=0,_obj.J_tie_index=0,$(".package-hide").show(),$(".package-body").removeClass("w645").addClass("w484")):_obj.tabClas=="salepackage"&&(_obj.J_tie_index=$(".package_index").find(".cur").parent().index(),ajaxData.packageIndex=$(".package_index").find(".cur").attr("data-index"))),t.children("a").removeClass(r),e.addClass(r),n.addClass("hide"),n.eq(s).removeClass("hide").addClass("show"),e.parents(".J_tabFixed").length&&tools.animateFun({scrollTop:parseInt($("#detailTop").offset().top-80)},300)},goNav:function(){var e=$(this),t=e.attr("data-id"),n=$("#"+t).offset().top;tools.animateFun({scrollTop:Math.ceil(n-90)},600,function(){e.parent().addClass("aside-cur")})},rushClick:function(){var e=$(this),t=$.trim(e.attr("data-local")),n="active",r=e.parents("li"),i=e.parents(".rush-info-box");closeSome(),e.hasClass(n)?e.removeClass(n).children("em").text("查看更多"):e.addClass(n).children("em").text("收合"),r.children("."+t).slideToggle(150)},addPrice:function(){var e=$(this);closeSome(),_obj.colloNum=Number(e.parents("p").next().find(".buyNum").val()),e.prop("checked")?e.attr("data-skuId")?getColl(this,2):getColl(this,0):getColl(this,1)},goshoping:function(){tools.close_dialog()},pieUser:function(){var e=$(".product-article"),t=$("#tabInner").children("a"),n=e.children().eq(1).children();t.removeClass("tab-cur"),t.eq(2).addClass("tab-cur"),n.removeClass("show hide").addClass("hide"),n.eq(2).removeClass("hide").addClass("show"),e.find(".J_tabFixed").length&&tools.animateFun({scrollTop:parseInt($("#detailTop").offset().top-80)},300)},ruleLocal:function(){var e=$(this),t=e.position(),n=$(".pre_sale_rule");return n.css({top:t.top+25}).show(),!1},ruleLocalClose:function(){return $(".pre_sale_rule").hide(),!1},auditfun:function(){var e=$(this).children(".audit-icon");e.hasClass("audit-up")?e.removeClass("audit-up").addClass("audit-down"):e.removeClass("audit-down").addClass("audit-up"),$(".audit-txt").slideToggle("slow")},feiniuService:function(){window.open(_base.embed_dispatch_url,"_blank")},feiniuTop:function(){$("html,body").animate({scrollTop:0},1e3)},sim_norms:function(){statics.tab.call($(".tab-inner").children("a").eq(1))},vipCodeshow:function(){var e=$(this),t=e.children(".nett-icon"),n=e.children(".nett-show");t.removeClass("nett-up").addClass("nett-down"),n.show()},vipCodehide:function(){var e=$(this),t=e.children(".nett-icon"),n=e.children(".nett-show");t.removeClass("nett-down").addClass("nett-up"),n.hide()},yanbaoShow:function(){var e=$(this),t=e.parent("ul"),n=e.children(".yanbao-tilte"),r=n.outerWidth(!0),i=e.children(".yanbao-select"),s=i.length>0?!0:!1;s&&($(".M_yanbao").find("li").css("z-index",0),e.css("z-index",2),n.addClass("borderBCFFF"),i.show())},yanbaoHide:function(){var e=$(this),t=e.children(".yanbao-tilte"),n=e.children(".yanbao-select");t.removeClass("borderBCFFF"),n.hide()},chooseYanbao:function(){var e=$(this),t=e.parent("ul"),n=e.children(".yanbao-tilte"),r=e.children(".yanbao-select"),i=r.length>0?!0:!1;n.hasClass("select")?n.removeClass("select"):i?(n.addClass("select"),r.hide(),n.removeClass("borderBCFFF")):n.addClass("select")},chooseAlert:function(){var e=$(this),t=e.html(),n=e.parents("ul"),r=e.parents("li"),i=e.attr("data-yanbaoid"),s=r.find(".yanbao-tilte"),o=r.find(".yanbao-select"),u=s.children("a");return u.attr("data-yanbaoid",i).html(t),s.addClass("select"),o.hide(),!1},chooseSale:function(){var e=$(this).index(),t=$(".sale-shop").children("ul");show_mobile_top(e),t.hide(),$(this).parent().children().removeClass("active"),$(this).addClass("active"),t.eq(e).show()},huabeiShow:function(){var e=$(this),t=e.position().left;e.children(".huabei-show").css("left",t).show()},huabeiHide:function(){$(".huabei-show").hide()},ruleHuabei:function(){$(".huabei_rule").show()},ruleHuabeiClose:function(){$(".huabei_rule").hide()},ok_hijacking:function(){var e=self.location,t=e.href;top.location=t},fail_hijacking:function(){top.location=www_domain},change_area:function(){var e=$(this),t=e.data("area-kind"),n=e.data("area-map"),r=bc_code+"_dist",i=bc_code+"_dist_area";tools.setCookie(r,t),tools.setCookie(i,n),location.reload()},close_area:function(){tools.close_dialog()}},ajaxFuns={addshop:function(event){function reser_presale(){var e=obj.base.mainshop,t=e.reservation,n=t.reservation_id,r=$(".youself-appointment"),i=$(".success-btn"),s=$(".fail-btn");r.hide(),i.hide(),s.hide(),e.is_reservation&&t.status==1?$.ajax({url:detail_url+c_item+"/check_customer",data:{activity_id:n},dataType:"jsonp",success:function(e){var i=e.data;if(!e.code){_obj._activityID=n;switch(i.is_appointment){case 0:r.show(),s.show(),dialogsFuns.toReseEnd(1,reservationMsg[2]);break;case 1:t.msg?(clear_from(),$("#input-verifi").attr("src",detail_url+c_item+"/get_vacode?t="+Date.parse(new Date)),dialogsFuns.toRese()):save_customer({activity_id:n,sm_seq:_sm_seq},0)}}else r.hide(),s.show(),dialogsFuns.toReseEnd(2,reservationMsg[3])}}):e.is_reservation&&t.status>2&&(t.appointment?normalShop():$.ajax({url:detail_url+c_item+"/check_customer",data:{activity_id:n},dataType:"jsonp",success:function(e){var t=e.data;switch(t.is_appointment){case 0:normalShop();break;case 1:r.hide(),s.show(),dialogsFuns.toReseEnd(2,reservationMsg[4])}}}))}function normalShop(){var e=$(".tbuyNum").val(),t=obj.verification.arr;if(!checkJson(t,_that))return;var n=obj.skuSeq_list[_sm_seq],r;n.sale_price_status==6?r=count_presale_qty(parseInt(e)):r=count_qty(parseInt(e));if(r.enough==0){$(".tbuyNum").val(r.main),tools.promptHtml("noenough",".create-txt");return}$(_that).removeClass(eve),addShopAjax(r)}function collectionShop(){if(validation.is_choose("gifts")&&validation.is_choose("combina"))if(checkArr()){var e=$(".tbuyNum").val(),t=count_collocation_item(parseInt(e));if(t.enough==0){$(".tbuyNum").val(t.main),tools.promptHtml("noenough","."+_obj.tabClas+"-txt");return}$(_that).removeClass(eve),addShopAjax(t)}else tools.promptHtml(_obj.tabClas,"."+_obj.tabClas+"-txt");else tools.promptHtml($(".V_gifts").length>0?"gifts":"combina","."+_obj.tabClas+"-txt")}function salepackageShop(){if(checkArr()){var e=$(_that).parents("li").find(".buyNum"),t=count_salepackage_qty(parseInt(e.val()),_obj.J_tie_index);if(t.enough==0){e.val(t.main<1?1:t.main),tools.promptHtml("noenough","."+_obj.tabClas+"-txt");return}$(_that).removeClass(eve),addShopAjax(t,"salepackage")}else tools.promptHtml(_obj.tabClas,"."+_obj.tabClas+"-txt")}function addShopAjax(e,t){var n={},r=obj.skuSeq_list[_sm_seq],i=[];r.sale_price_status==6?n.cart_type=3:r.is_pre_order==1?n.cart_type=1:n.cart_type=0,btn_free_type&&(n.cart_type=btn_free_type),n.product_list=[];if(obj.base.is_orgi_item==2)i.push({sku_id:r.sku_seq,type:0,qty:e.main,parent_seq:"",kind:12,campaign_seq:""});else if(t=="salepackage"){var s=e.salepackage,o=[];for(var u in s){if(!s.hasOwnProperty(u))continue;var a=get_smseq_by_sku(u);o.push(a)}var f=o.join(",");i.push({sku_id:f,type:0,qty:e.main,parent_seq:ajaxData.packageIndex,kind:13,campaign_seq:""})}else{i.push({sku_id:r.sku_seq,type:0,qty:e.main,parent_seq:"",kind:1,campaign_seq:""});var l=e.gift,c=e.collocation;for(var h in l){if(!l.hasOwnProperty(h))continue;i.push({sku_id:h,type:0,qty:l[h],parent_seq:r.sku_seq,kind:23,campaign_seq:""})}for(var h in c){if(!c.hasOwnProperty(h))continue;i.push({sku_id:h,type:0,qty:c[h],parent_seq:r.sku_seq,kind:3,campaign_seq:""})}if(obj.base.is_orgi_item=="0")for(var p in ajaxData.combina){if(!ajaxData.combina.hasOwnProperty(p))continue;i.push({sku_id:ajaxData.combina[p],type:0,qty:e.main,parent_seq:r.sku_seq,kind:6,campaign_seq:""})}}n.product_list.push(i);var d={sendData:n,done:function(t){var n=t.other;if(t.status==1){$("#addCartBox .fresh-tip").hide();var i=n.is_pre,s=n.is_sen,o=n.is_ssm,u=parseInt(n.max_num),a=parseInt(n.buy_num),f=u-a?u-a:0,l=e.main,c=0;if(r.sale_price_status==6){window.location.href="https://buy."+source_domain+"/order/index?cart_type=3";return}if(i){window.location.href="https://buy."+source_domain+"/order/index?cart_type=1";return}if(btn_free_type){window.location.href="https://buy."+source_domain+"/order/index?cart_type="+btn_free_type;return}o&&u>-1&&obj.skuSeq_list[_sm_seq].is_sell_over_limit==1&&a+l>u&&(dialogsFuns.addCart(1,"此商品限购 "+u+" 件, 您已购买过 "+a+" 件, 只能加入 "+f+" 件商品到购物车！"),c=1),s&&(dialogsFuns.addCart(0,"此商品为敏感商品，仅支持支付平台、网银支付，请半小时内付款成功，否则订单将自动取消。"),c=1),c==0&&($("#addCartBox .fresh-tip").show(),dialogsFuns.addCart(0,addshopMsg[0])),$("#dsp_script").length<=0&&$("#focus_cart").after("<div id='dsp_script' style='display:none;'></div>"),typeof n.baidu_dsp_script_string!="undefined"&&$("#dsp_script").html(n.baidu_dsp_script_string)}else t.status!=2&&t.status!=3||!btn_free_type?t.status!=2&&t.status!=3||!!btn_free_type?t.status==0&&dialogsFuns.addCart(2,addshopMsg[1]):dialogsFuns.addCart(2,t.msg):dialogsFuns.addCart(2,t.msg);$(_that).addClass(eve)}};addListToCart(d)}var _that=this,current_sm=obj.skuSeq_list[obj.base.sku_seq],btn_free_type=$(_that).hasClass("btn-free")?7:0,$create_txt=$(".create-txt"),eve=$(_that).hasClass("flyShop")?"flyShop":$(_that).hasClass("addshop-tab")?"addshop-tab":$(_that).hasClass("salepackage-btn")?"salepackage-btn":$(_that).hasClass("collocation-btn")?"collocation-btn":$(_that).hasClass("addshop-btn")?"addshop-btn":"";$create_txt.empty(),closeSome(),current_sm.sale_price_status==6||(current_sm.sale_price_status==2||current_sm.sale_price_status==3||current_sm.sale_price_status==4)&&current_sm.show_special_data.ssm_limit_qty!=null&&current_sm.show_special_data.ssm_limit_qty!=0||obj.base.is_sensitive==1||_obj._privilege||obj.base.is_ingeral==1||btn_free_type==7?$.ajax({url:ac_url+"/check_login/v1?v="+Date.parse(new Date),dataType:"jsonp",success:function(data){if(data.code!==0)fnDialog();else{if(obj.base.sm_group_type==5)return window.location.href=obj.base.mobile_packages_link,!1;eval(event.data.func_name+"();")}}}):eval(event.data.func_name+"();")},returnVerifi:function(){$(this).attr("src",detail_url+c_item+"/get_vacode?t="+Date.parse(new Date))},saleService:function(){var e=$(".detail-service"),t=e.data("isInit");if(_base.it_in_type==3&&_base.is_fresh_prod==0&&typeof _base.after_service!="undefined"&&_base.after_service!=null&&_base.after_service!="")return!1;t==null&&$.post(detail_url+c_item+"/getAfterServiceHtml?v="+Date.parse(new Date),{it_in_type:_base.it_in_type,is_fresh_prod:_base.is_fresh_prod,sup_seq:_base.sup_seq,fresh_area:typeof _base.fresh_area=="undefined"?"":_base.fresh_area},function(t){e.data("isInit","1").append(t)},"html")},getphoneVerifi:function(){var e=$("#reservation-box"),t=e.find(".txt-phone-num"),n=e.find(".txt-phone-verifi"),r=e.find(".txt-phone-num ~ i"),i=e.find(".txt-verifi"),s=e.find(".txt-verifi ~ i"),o=$.trim(t.val()),u=$.trim(i.val()),a=$.trim(n.val()),f=!0,l=validation.is_null(o),c=validation.checkMobile(o),h=validation.is_null(u);if(l||!c)t.parent().addClass("go-error"),r.html(usernameMsg[4]),f=!1;validation.is_null(u)&&(i.parent().addClass("go-error"),s.html(usernameMsg[9]),f=!1),f&&(t.parent().removeClass("go-error"),i.parent().removeClass("go-error"),r.empty(),s.empty(),$.ajax({url:detail_url+c_item+"/get_sms_vacode",dataType:"jsonp",data:{mobile:o,randcode:u},success:function(e){var t=e.data;e.code?e.code=="-1521"?$("#input-verifi").attr("src",detail_url+c_item+"/get_vacode?t="+Date.parse(new Date)):(i.parent().addClass("go-error"),s.html("*"+e.msg)):tools.strto_time(t.expire,$("#phone-verif-time"),$("#phone-verifi"))}}))},toPrice:function(){$.ajax({url:ac_url+"/check_login/v1?v="+Date.parse(new Date),dataType:"jsonp",success:function(e){if(e.code!==0)fnDialog();else{var t=$("#toprice-box"),n=e.data.email,r=e.data.phone,i=$.trim($("#J_product_value .fn-rmb-num").html()).replace(/,/g,"");dialogsFuns.toPrice(),t.find(".txt-price").val(i),t.find(".txt-phone-num").val(r),t.find(".txt-email").val(n)}}})},toPriceSubmit:function(){var e=this,t=$("#toprice-box"),n=t.find(".txt-email"),r=t.find(".txt-phone-num"),i=t.find(".txt-price"),s=t.find(".txt-email ~ i"),o=t.find(".txt-phone-num ~ i"),u=t.find(".txt-price ~ i"),a=t.find(".radio"),f=$.trim(n.val()),l=$.trim(r.val()),c=$.trim(i.val()),h=$.trim($("#J_product_value .fn-rmb-num").html()).replace(/,/g,""),p=!0;validation.is_null(c)?(p=!1,i.parent().addClass("go-error"),u.html(usernameMsg[0])):validation.isMoney(c)?parseFloat(h)<=parseFloat(c)?(p=!1,i.parent().addClass("go-error"),u.html(usernameMsg[2])):(i.parent().removeClass("go-error"),u.html("")):(p=!1,i.parent().addClass("go-error"),u.html(usernameMsg[1]));var d=validation.is_null(f),v=validation.isEmail(f),m=validation.is_null(l),g=validation.checkMobile(l),y=!0;!d&&!v&&(n.parent().addClass("go-error"),s.html(usernameMsg[3]),p=!1,y=!1),!m&&!g&&(r.parent().addClass("go-error"),o.html(usernameMsg[4]),p=!1,y=!1),m&&d&&(n.parent().addClass("go-error"),s.html(usernameMsg[5]),r.parent().addClass("go-error"),o.html(usernameMsg[5]),p=!1,y=!1),y&&(n.parent().removeClass("go-error"),r.parent().removeClass("go-error"),o.html(""),s.html());if(p){var b={email:f,phone:l,sm_seq:_sm_seq,sm_name:obj.base.sm_slogan,sm_status:usernameMsg[6],sm_pattern:get_ch_smPattern(),sm_price:h,usr_price:c};$.ajax({url:ac_url+"/add_price_cut_notice/v1?data="+tools.en_code(JSON.stringify(b))+"&v="+Date.parse(new Date),dataType:"jsonp",beforeSend:function(){$(e).removeAttr("id")},success:function(e){e.code==-1501&&fnDialog(),e.code==0?dialogsFuns.toPriceEnd(0,toPriceMsg[0]):dialogsFuns.toPriceEnd(2,toPriceMsg[2]),a.prop("checked")&&collect_no_dialog()},complete:function(){$(e).attr("id","topriceSubmit")}})}},toGoods:function(){$.ajax({url:ac_url+"/check_login/v1?v="+Date.parse(new Date),dataType:"jsonp",success:function(e){if(e.code!==0)fnDialog();else{var t=$("#togoods-box"),n=e.data.email,r=e.data.phone;dialogsFuns.toGoods(),t.find(".txt-phone-num").val(r),t.find(".txt-email").val(n)}}})},toGoodsSubmit:function(){var e=this,t=$("#togoods-box"),n=t.find(".txt-email"),r=t.find(".txt-phone-num"),i=t.find(".txt-email ~ i"),s=t.find(".txt-phone-num ~ i"),o=t.find(".radio"),u=n.val(),a=r.val(),f=!0,l=!1;!validation.is_null(u)&&validation.isEmail(u)?(n.parent().removeClass("go-error"),r.parent().removeClass("go-error"),i.html(""),l=!0):!validation.is_null(u)&&!validation.isEmail(u)&&(n.parent().addClass("go-error"),i.html(usernameMsg[3]),f=!1),!validation.is_null(a)&&validation.checkMobile(a)?(n.parent().removeClass("go-error"),r.parent().removeClass("go-error"),s.html(""),l=!0):!validation.is_null(a)&&!validation.checkMobile(a)&&(r.parent().addClass("go-error"),s.html(usernameMsg[4]),f=!1),!l&&f&&(n.parent().addClass("go-error"),i.html(usernameMsg[5]),r.parent().addClass("go-error"),s.html(usernameMsg[5]),f=!1);if(f){var c={email:u,phone:a,sm_seq:_sm_seq,sm_name:obj.base.sm_slogan,sm_status:usernameMsg[6],sm_pattern:get_ch_smPattern()};$.ajax({url:ac_url+"/add_arrival_notice/v1?data="+tools.en_code(JSON.stringify(c))+"&v="+Date.parse(new Date),dataType:"jsonp",success:function(e){e.code==-1501&&fnDialog(),e.code==0?dialogsFuns.goGoodsEnd(0,toGoodsMsg[0]):dialogsFuns.goGoodsEnd(2,toGoodsMsg[2]),o.prop("checked")&&collect_no_dialog()}})}},collect:function(){var e=ac_url+"/add_favorite/v1",t=_sm_seq,n={type:0,price:$.trim($("#J_product_value").find(".fn-rmb-num").html()),favorite_seq:t,seq_kind:obj.base.is_orgi_item=="2"?1:0,v:Date.parse(new Date)};$.ajax({url:e,dataType:"jsonp",data:n,success:function(e){e.code==-1501?fnDialog():e.code==0?($("#collectLink i").removeClass("collect-ico-null"),$("#collectLink i").addClass("collect-ico-ok"),$("#collectLink .collect-text").text(collectMsg[5]),dialogsFuns.collect(0,collectMsg[0]),show_collection()):e.code==10005?dialogsFuns.collect(1,collectMsg[1]):e.code==10010?dialogsFuns.collect(1,collectMsg[3]):e.code==10011?dialogsFuns.collect(1,collectMsg[4]):dialogsFuns.collect(2,collectMsg[2])},error:function(e){dialogsFuns.collect(2,collectMsg[2])}})},addCoupon:function(){var e=$(this),t=e.data("seq");e.removeClass("addCoupon"),$.ajax({url:detail_url+c_item+"/get_voucher?va_seq="+t+"&v="+Date.parse(new Date),dataType:"jsonp",success:function(e){if(e.code==-1501){fnDialog();return}if(e.code==0){var n,r="";for(var i in obj.voucher.data){if(!obj.voucher.data.hasOwnProperty(i))continue;if(obj.voucher.data[i].seq==t){n=obj.voucher.data[i];break}}n.va_postal_type==4?($(".postal_type").html("使用范围：限品牌商品"),r="恭喜您品牌券领取成功！"):($(".postal_type").html("使用范围：限飞牛自营商品"),r="恭喜您优惠券领取成功！"),dialogsFuns.addCoupon(0,r),$("#addCoupon-box .conect-title").children(":gt(0)").show(),$("#addCoupon-box .promote").html(n.promote_text),$("#addCoupon-box .promote-time").html(n.va_start_date.replace(/-/g,"/")+"-"+n.va_end_date.replace(/-/g,"/")),n.spare_num===-1?$("#addCoupon-box .va_take_qty").parent("p").hide():n.spare_num>0&&(n.spare_num--,n.spare_num===0&&(n.is_owned=1)),$("#addCoupon-box .va_take_qty").html(n.spare_num),obj.voucher.data.sort(function(e,t){return e.spare_num==0?1:-1}),tools.temp("S_voucher","J_voucher",obj.voucher)}else dialogsFuns.addCoupon(2,e.msg),$("#addCoupon-box .conect-title").children(":gt(0)").hide(),$("#addCoupon-box .conect-title").children("p").show()},complete:function(){e.addClass("addCoupon")}})},reserSubmit:function(){var e=_obj._activityID,t=this,n=$("#reservation-box"),r=n.find(".txt-phone-num"),i=n.find(".txt-phone-num ~ i"),s=n.find(".txt-verifi"),o=n.find(".txt-verifi ~ i"),u=n.find(".txt-phone-verifi"),a=n.find(".txt-phone-verifi ~ i"),f=$.trim(r.val()),l=$.trim(s.val()),c=$.trim(u.val()),h=!0,p=validation.is_null(f),d=validation.checkMobile(f),v=validation.is_null(l),m=validation.is_null(c),g=$(".youself-appointment"),y=$(".success-btn"),b=$(".fail-btn");p&&!d?(r.parent().addClass("go-error"),i.html(usernameMsg[4]),h=!1):r.parent().removeClass("go-error"),validation.checkMobile(f)?r.parent().removeClass("go-error"):(r.parent().addClass("go-error"),i.html(usernameMsg[4]),h=!1),validation.is_null(l)?(s.parent().addClass("go-error"),o.html(usernameMsg[9]),h=!1):s.parent().removeClass("go-error"),validation.is_null(c)?(u.parent().addClass("go-error"),a.html(usernameMsg[10]),h=!1):u.parent().removeClass("go-error"),h&&(r.parent().removeClass("go-error"),s.parent().removeClass("go-error"),u.parent().removeClass("go-error"),i.empty(),o.empty(),a.empty(),$.ajax({url:detail_url+c_item+"/check_vacode?randcode="+l,dataType:"jsonp",success:function(t){t.code<0?(s.parent().addClass("go-error"),o.html("*"+t.msg),t.code==-1521&&$("#input-verifi").attr("src",detail_url+c_item+"/get_vacode?t="+Date.parse(new Date))):(s.parent().removeClass("go-error"),save_customer({activity_id:e,mobile:f,sm_code:c,sm_seq:_sm_seq},1))}}))}},collect_no_dialog=function(){var e=ac_url+"/add_favorite/v1",t=_sm_seq,n={type:0,price:$.trim($("#J_product_value").find(".fn-rmb-num").html()),favorite_seq:t,seq_kind:obj.base.is_orgi_item=="2"?1:0,v:Date.parse(new Date)};$.ajax({url:e,dataType:"jsonp",data:n,success:function(e){e.code==0&&show_collection()}})},judge_AS=function(e,t){var n=e.parents(".number"),r=n.children(".mins"),i=n.children("input"),s=n.children(".add"),o=$(".create-txt"),u=_mainshop.pre_sale_data,a=_mainshop.show_special_data;o.empty(),s.removeClass("no-mins");if(typeof _mainshop.is_mobile_price!="undefined"&&_mainshop.is_mobile_price==1)return!1;if(_base.is_orgi_item==2){var f=_base.mult_one_sm_seq,l=_base.mult_qty,c=t*l,h=obj.skuSeq_list[f];a=h.show_special_data;if(h.qty<c)return i.val(Math.floor(h.qty/l)),s.addClass("no-mins"),o.text("选择套餐已超过可买数量"),!1}if(_mainshop.sale_price_status==6&&t>u.limitNum&&u.is_limit)return i.val(u.limitNum),!1;if(_base.is_ingeral==1){var p=_mainshop.privilege,d=p.sale_info,v=d.is_limit,m=d.limit_quantity;v==1&&t>m&&(i.val(m),s.addClass("no-mins"))}a!=null&&a.surplus_null==0&&a.is_sell_over_limit?(a.ssm_limit_qty&&t>a.ssm_limit_qty&&(i.val(a.ssm_limit_qty),s.addClass("no-mins")),a.ssm_active_qty&&t>a.ssm_active_qty&&(i.val(a.ssm_active_qty),s.addClass("no-mins"))):a!=null&&a.surplus_null==1&&a.is_sell_over_limit?((_mainshop.sale_price_status==2||_mainshop.sale_price_status==3)&&t>a.ssm_active_qty&&o.text("您所选择的商品数量超过促销库存"),(_mainshop.sale_price_status==2||_mainshop.sale_price_status==4)&&a.ssm_limit_qty&&t>a.ssm_limit_qty&&(i.val(a.ssm_limit_qty),s.addClass("no-mins"))):a!=null&&a.surplus_null==1&&!a.is_sell_over_limit&&a.ssm_limit_qty&&t>a.ssm_limit_qty&&o.text("已超过优惠价可买数量")},huabei_AS=function(e){if(typeof _obj.huabei=="undefined")return!1;var t=obj.current_price,n=_obj.huabei,r=Number(n.min_money),i=Number(n.max_money),s=Number(n.free_min_money),o=Number(n.free_max_money),u=e*t,a=$(".create-txt");a.empty(),u>o&&a.html("免息分期金额不可超过"+o),u<s&&a.html("免息分期金额不可少于"+s),u>i&&a.html("分期金额不可超过"+i),u<r&&a.html("分期金额不可少于"+r)},collocation_AS=function(e,t){if(typeof obj.collocation=="undefined"||!obj.collocation.dis)return!1;if(e.parent().find("input").hasClass("tbuyNum")&&!_mainshop.is_sell_over_limit&&!_mainshop.ssm_limit_qty){var n=$(".collocation").children("li"),r=$(".J_collocation").next().find(".fn-rmb-num"),i=Number($("#J_product_value").find(".fn-rmb-num").html()),s,o,u=0,a=0;s=tools.changeTwoDecimal(Number(i)*t);for(var f=0;f<n.length;f++){var l=$(n[f]).index()-$(n[f]).prevAll("li[class='package-add']").length;$(n[f]).find("input[type='checkbox']").prop("checked")&&($(n[f]).find(".buyNum").val()>t?($(n[f]).find(".buyNum").val(t),createIndexArr(_obj.tabClas+_obj.J_tie_index,$(n[f]).find("input[type='checkbox']").attr("data-skuId")+"_"+t,l),_obj.countNum[l]=t,u+=Number(obj[_obj.tabClas+"sprice"+_obj.J_tie_index][l])*t,a+=(Number(obj[_obj.tabClas+"price"+_obj.J_tie_index][l])-Number(obj[_obj.tabClas+"sprice"+_obj.J_tie_index][l]))*t):(u+=Number(obj[_obj.tabClas+"sprice"+_obj.J_tie_index][l])*_obj.countNum[l],a+=(Number(obj[_obj.tabClas+"price"+_obj.J_tie_index][l])-Number(obj[_obj.tabClas+"sprice"+_obj.J_tie_index][l]))*_obj.countNum[l]),s=tools.changeTwoDecimal(Number(i)*t+u))}tools.createHtml(r.eq(0),tools.changeTwoDecimal(s)),tools.createHtml(r.eq(1),tools.changeTwoDecimal(a))}},closeSome=function(){$(".small-layer").hide()},getColl=function(e,t,n){var r=$(e),i=_obj.colloNum,s=_obj.tabClas,o=_obj.J_tie_index,u=r.parents("li"),a=u.index(),f=a-u.prevAll("li[class='package-add']").length,l=i*tools.changeTwoDecimal(obj[s+"price"+o][f]),c=i*tools.changeTwoDecimal(obj[s+"sprice"+o][f]),h=$(".J_collocation").next().find(".fn-rmb-num"),p=h.eq(0).html(),d=h.eq(1).html(),v=Number(p),m=Number(d),g=tools.changeTwoDecimal(c-l),y=$(h.eq(1)).parent(".total-save"),b=r.attr("data-skuId")==""?n:r.attr("data-skuId");_obj.countNum[f]=Number(r.parents("p").next().find(".buyNum").val());switch(t){case 0:r.prop("checked",!0),tools.createHtml(h.eq(0),tools.changeTwoDecimal(v+l)),m+g<=0?y.hide():y.show(),tools.createHtml(h.eq(1),tools.changeTwoDecimal(m+g)),_obj.num++,b!=""&&typeof b!="undefined"?createIndexArr(_obj.tabClas+_obj.J_tie_index,b+"_"+_obj.colloNum,f):tools.promptHtml("size","."+_obj.tabClas+"-txt");break;case 1:r.prop("checked",!1),tools.createHtml(h.eq(0),tools.changeTwoDecimal(v-l)),m-g<=0?y.hide():y.show(),tools.createHtml(h.eq(1),tools.changeTwoDecimal(m-g)),_obj.num--,removeIndexArr(_obj.tabClas+_obj.J_tie_index,f);break;case 2:r.prop("checked",!0),tools.createHtml(h.eq(0),tools.changeTwoDecimal(v+l)),m+g<=0?y.hide():y.show(),tools.createHtml(h.eq(1),tools.changeTwoDecimal(m+g)),_obj.num++,createIndexArr(_obj.tabClas+_obj.J_tie_index,b+"_"+_obj.colloNum,f);break;case 3:createIndexArr(_obj.tabClas+_obj.J_tie_index,b+"_"+_obj.colloNum,f)}tools.createHtml($(".total_index"),_obj.num)},selectLength=function(e,t,n,r,i,s){var o=e>0?i.children().eq(1):$(".J_etalon"),u=e>0?i.children().eq(0):$(".J_color"),a=t=="color"?o:u,f=i.find(".select").length;tools.addData($(".c_mobile_url"),"href","javascript:;");switch(f){case 0:i.find("li").removeClass("nosold"),r.size.length?(once(r.color,u.children("li")),once(r.size,o.children("li"))):once(r.color,u.children("li")),e||priceRange(0);break;case 1:if(r.size.length){e||priceRange(0);if(t==="size"&&!s)return u.children("li").removeClass("nosold"),once(r.color,u.children("li")),!1;if(t==="color"&&!s)return o.children("li").removeClass("nosold"),once(r.size,o.children("li")),!1;is_status(r,n,t,a,s)}else if(!e&&t!="size"){var l=n.children("span").data("id");_obj.arrIfno[0]=l,create_url(r,n,t,a)}break;case 2:is_status(r,n,t,a,s),e||(is_type(t,n),create_url(r,n,t,a,s))}},priceRange=function(e){var t=_base.range_price,n=$(".refer"),r=$(".nett"),i=n.children(".send"),s=$("#point"),o=n.children(".attr"),u=n.children("del"),a=r.children(".fn-price-label"),f=r.find(".nett-box-value").children(".fn-rmb-num"),l=$(".product-minheight"),c=l.children(".rush"),h=$("#J_package_list,.package");switch(e){case 0:_obj["sendhide"]=="show"?s.html(_base.min_point+" 起"):"",_obj["attrnone"]=="block"?o.css("display","none"):"",_obj["delnone"]=="block"?u.css("display","none"):"",_obj["mainpricetag"]==1?a.html("飞 牛 价"):"",t.is_show&&f.html(t.min+"~"+t.max),obj.is_promotion==1?c.hide():"",h.hide();break;case 1:_obj["sendhide"]=="show"?s.html(_base.point):"",o.css("display")=="none"&&_obj["attrnone"]=="block"?o.css("display","block"):"",u.css("display")=="none"&&_obj["delnone"]=="block"?u.css("display","block"):"",_obj["mainpricetag"]==1?a.html("优 惠 价"):"",f.html(_mainshop.sale_price),obj.is_promotion==1?c.show():"",typeof obj.collocation!="undefined"&&obj.collocation.dis||typeof obj.salepackage!="undefined"&&obj.salepackage.dis?h.show():""}},alertChoose=function(e,t,n,r){var i=t=="color"?"size":"color",s=i=="color"?r.children().eq(0):r.children().eq(1);s.children("li").addClass("nosold");for(var o=0,u=e[t];o<u.length;o++)if(u[o]["seq"]==e[n])for(var a=0,f=u[o][i+"_seq"];a<f.length;a++)f[a][i=="size"?tools.de_code(f[a].seq):f[a].seq]>0&&htmlSeq(f[a].seq,s)},once=function(e,t){for(var n=0,r=e;n<r.length;n++)e[n].status||$(t[n]).addClass("nosold")},is_status=function(e,t,n,r,i){r.find("li").addClass("nosold");var s=n=="size"?"color":"size";for(var o=0,u=e[n][i?t.index():r.find("li.select").index()][s+"_seq"];o<u.length;o++)u[o][s=="size"?tools.de_code(u[o].seq):u[o].seq]>0?checkeSeq(e,r,s,u[o].seq):r.find("li.select").length&&r.children("li").eq(o).removeClass("select")},checkeSeq=function(e,t,n,r){for(var i=0,s=e[n];i<e[n].length;i++)r==s[i].seq&&s[i].status&&htmlSeq(r,t)},htmlSeq=function(t,n){for(var r=0,i=n.find("span");r<i.length;r++)t==$(i[r]).attr("data-id")&&$(i[r]).parent().removeClass("nosold")},is_type=function(e,t){switch(e){case"color":var n=t.children("span").data("id"),r=t.parents("dl").next().find(".select");r.length>0&&(_obj.arrIfno[0]=n,_obj.arrIfno[1]=r.children("span").data("id"));break;case"size":var i=t.children("span").data("id"),s=t.parents("dl").prev().find(".select");s.length>0&&(_obj.arrIfno[0]=s.children("span").data("id"),_obj.arrIfno[1]=i)}},create_url=function(e,t,n,r,i){try{var s=obj.spec_dict[_obj.arrIfno.join("_")].sku_seq;if(s&&s!=_base.sku_seq)tools.createURL(s);else if(s)priceRange(1);else{var o=n=="color"?$(".J_color"):$(".J_etalon");o.children("li.select").addClass("nosold"),o.children("li").removeClass("select"),$(".M_size").html("")}}catch(u){var o=n=="color"?$(".J_etalon"):$(".J_color");o.children("li").removeClass("select"),is_status(e,t,n,r,i),$(".M_size").html("")}},colloerraler=function(e,t){var n=Number($("#productNorm").find(".buyNum").val()),r=e.parents(".total-number").find(".buyNum"),i=t,s=e.parents(".total-number").offset(),o=e.parents("p").prev().find("input[type='checkbox']"),u=o.attr("data-skuId"),a=_obj.tabClas,f=_obj.J_tie_index,l=$(".J_collocation").next().find(".fn-rmb-num"),c=Number(l.eq(0).html()),h=Number(l.eq(1).html()),p=0,d=0,v=e.parents("li"),m=v.index(),g=m-v.prevAll("li[class='package-add']").length,y=typeof _obj.countNum[g]=="undefined"?1:_obj.countNum[g];$("#purchase").css({position:"absolute",top:s.top-25,left:s.left}).hide();if(n>=i)if(u){if(i>obj.skuSeq_list[u].qty){_base.mainshop.sale_price_status==2?tools.promptHtml("noenoughActive","#purchase"):tools.promptHtml("noenough","#purchase"),r.val(obj.skuSeq_list[u].qty),$("#purchase").show(),createIndexArr(a+f,u+"_"+obj.itno_list[u].qty,g);return}if(o.prop("checked")){if(i==y)return!1;i>y?(p=c+tools.changeTwoDecimal((i-y)*Number(obj[a+"sprice"+f][g])),d=h+tools.changeTwoDecimal((i-y)*Number(obj[a+"price"+f][g])-(i-y)*Number(obj[a+"sprice"+f][g])),_obj.colloNum=i):i<y&&(p=c-tools.changeTwoDecimal((y-i)*Number(obj[a+"sprice"+f][g])),d=h-tools.changeTwoDecimal((y-i)*Number(obj[a+"price"+f][g])-(y-i)*Number(obj[a+"sprice"+f][g])),_obj.colloNum=i),tools.createHtml(l.eq(0),tools.changeTwoDecimal(p)),tools.createHtml(l.eq(1),tools.changeTwoDecimal(d)),createIndexArr(a+f,u+"_"+i,g),_obj.countNum[g]=i}}else tools.promptHtml("salepackage","#purchase"),r.val(1),$("#purchase").show();else tools.promptHtml("purchase","#purchase"),r.val(n),$("#purchase").show(),createIndexArr(a+f,u+"_"+n,g)},save_customer=function(e,t){var n=$(".youself-appointment"),r=$(".success-btn"),i=$(".fail-btn"),s=$("#reservation-box"),o=s.find(".txt-phone-verifi"),u=s.find(".txt-phone-verifi ~ i");$.ajax({url:detail_url+c_item+"/save_customer",dataType:"jsonp",data:e,success:function(e){if(!e.code&&e.data){var s=e.data.appointment_status;switch(s){case 0:n.show(),r.show(),dialogsFuns.toReseEnd(0,t==0?reservationMsg[1]:reservationMsg[0]);break;case 1:o.parent().addClass("go-error"),u.html("*"+e.msg);break;case 2:n.show(),i.show(),dialogsFuns.toReseEnd(1,reservationMsg[2])}}}})},checkJson=function(e,t){for(var n=0;n<e.length;n++)if($(".V_"+e[n]).length>0&&e[n]!=("collocation"&&"salepackage"))return $(t).hasClass("addshop-create")&&tools.animateFun({scrollTop:$(".container").offset().top},600),tools.promptHtml(e[n],".create-txt"),!1;return!0},checkArr=function(){var e=null,t=ajaxData[_obj.tabClas+_obj.J_tie_index];if(!t.length)return!1;if(_obj.tabClas=="salepackage")e=$("."+_obj.tabClas).parent().children().eq(_obj.J_tie_index).children("li:not('.package-add')");else if(_obj.tabClas=="collocation"){var n=[];for(var r=0,i=$("."+_obj.tabClas).find("input[type='checkbox']");r<i.length;r++)$(i[r]).prop("checked")&&n.push(i[r]);e=n}for(var s=0;s<e.length;s++){if(_obj.tabClas=="salepackage"&&$("."+_obj.tabClas).parent().children().eq(_obj.J_tie_index).children().hasClass("V_"+_obj.tabClas))return!1;if(_obj.tabClas=="collocation"&&!indexOf_list(t,$(e[s]).attr("data-skuId")))return!1}return!0},indexOf_list=function(e,t){for(var n in e){if(!e.hasOwnProperty(n))continue;if(e[n].indexOf(t)>-1)return!0}return!1},get_ch_smPattern=function(){var e=obj.skuSeq_list[_sm_seq].sale_price_status;switch(e){case 1:return saleType[9];case 2:return saleType[10];case 3:return saleType[11];case 4:return saleType[12];default:return saleType[9]}},clear_from=function(){var e=$(".rese-content"),t=e.find(".txt-phone-num"),n=e.find(".txt-verifi"),r=e.find(".txt-phone-verifi");t.val(""),r.val(""),n.val(""),$(".go-error").removeClass("go-error")},createIndexArr=function(e,t,n){var r=ajaxData[e];r[n]=t},removeIndexArr=function(e,t){var n=ajaxData[e];n.splice(t,1)},count_qty=function(e){var t={main:0,enough:!0,gift:{},accessorie:{},salepackage:{},collocation:{}},n=obj.skuSeq_list[_sm_seq],r=n.show_special_data,i=0,s=0;obj.base.is_orgi_item==2&&(n=obj.skuSeq_list[obj.base.mult_one_sm_seq],r=n.show_special_data),n.sale_price_status==2&&(i=r.surplus_null,s=r.is_sell);var o=ajaxData.combina,u=ajaxData.gifts,a=jQuery.extend(!0,{},obj.skuSeq_list);for(var f=0;f<e;f++){for(var l in o)if(typeof a[o[l]]!="undefined"){n.is_pre_order==1&&(a[o[l]].qty=n.pre_ava_qty);var c=1;obj.base.is_orgi_item==2&&(c=obj.base.mult_qty,o[l]=obj.base.mult_one_sm_seq),a[o[l]].qty>=c?(a[o[l]].qty-=c,(n.sale_price_status==3||n.sale_price_status==2)&&s!=0&&i==0&&n.ssm_rplus_qty<=f&&(e=f,t.enough=!1)):(e=f,t.enough=!1)}for(var l in u)typeof a[u[l]]!="undefined"&&(a[u[l]].qty>0&&(typeof t.gift[u[l]]=="undefined"&&(t.gift[u[l]]=0),t.gift[u[l]]++),a[u[l]].qty--)}return t.main=e,t},count_presale_qty=function(e){var t={main:0,enough:!0,gift:{},accessorie:{},salepackage:{},collocation:{}},n=obj.skuSeq_list[_sm_seq],r=ajaxData.combina,i=ajaxData.gifts,s=jQuery.extend(!0,{},obj.skuSeq_list),o=n.remainQty;for(var u=0;u<e;u++){for(var a in r)typeof s[r[a]]!="undefined"&&(s[r[a]].qty--,o--);for(var a in i)typeof s[i[a]]!="undefined"&&(s[i[a]].qty>0&&(typeof t.gift[i[a]]=="undefined"&&(t.gift[i[a]]=0),t.gift[i[a]]++),s[i[a]].qty--,obj.base.is_orgi_item==1&&_sm_seq==i[a]&&o--)}return t.main=e,t},count_salepackage_qty=function(e,t){var n={main:0,enough:!0,gift:{},accessorie:{},salepackage:{},collocation:{}},r=ajaxData["salepackage"+t],i=jQuery.extend(!0,{},obj.skuSeq_list);for(var s=0;s<e;s++)for(var o in r)typeof i[r[o]]!="undefined"&&(i[r[o]].qty>0?(typeof n.salepackage[r[o]]=="undefined"&&(n.salepackage[r[o]]=0),n.salepackage[r[o]]++,i[r[o]].qty--):(e=s,n.enough=!1));return n.main=e,n},count_collocation_item=function(e){var t=ajaxData.combina,n=ajaxData.gifts,r=ajaxData["collocation"+ajaxData.packageIndex],i=jQuery.extend(!0,{},obj.skuSeq_list),s={main:0,gift:{},accessorie:{},salepackage:{},collocation:{}};for(var o=0;o<e;o++){for(var u in t)if(typeof i[t[u]]!="undefined"){var a=1;obj.base.is_orgi_item==2&&(a=obj.base.mult_qty),i[t[u]].qty>=a?i[t[u]].qty-=a:(e=o,s.enough=!1)}for(var u in n)typeof i[n[u]]!="undefined"&&(i[n[u]].qty>0&&(typeof s.gift[n[u]]=="undefined"&&(s.gift[n[u]]=0),s.gift[n[u]]++),i[n[u]].qty--)}for(var u in r){if(!r.hasOwnProperty(u))continue;var f=r[u].split("_")[0],l=r[u].split("_")[1];i[f].qty>=l?(s.collocation[f]=l,i[f].qty-=l):s.enough=!1}return s.main=e,s},get_smseq_by_sku=function(e){for(var t in obj.skuSeq_list){if(!obj.skuSeq_list.hasOwnProperty(t))continue;if(_sm_seq==e)return _sm_seq;if(obj.skuSeq_list[t].sku_seq==e)return t}return""},hijacking=function(){top.location!==self.location&&dialogsFuns.tohijacking()},show_collection=function(){$.ajax({url:ac_url+"/get_collection_count/v1?sku_seq="+_sm_seq+"&v="+Date.parse(new Date),dataType:"jsonp",success:function(e){if(e.status){var t=e.data;t>0&&$(".J_FavCount").html("("+t+")")}}})},show_mobile_top=function(e){var t=$(".sale-shop").children().eq(e);if(t.children().length)return!1;$.ajax({url:detail_url+c_item+"/hot_recommend?brand="+brandId+"&category="+obj.base.cp_seq+"&price="+obj.current_price+"&type="+(e+1),dataType:"json",success:function(e){if(e.code==0){var n=e.data.list;for(var r=0;r<n.length;r++){if(r>8)return;var i=n[r].title,s=n[r].pic,o=n[r].price,u=n[r].link,a=n[r].it_mprice,f="";f+="<li>",f+='<a href="'+u+'" class="look-img"  target="_blank" title="'+i+'">',f+='<img src="'+s+'">',f+='<div class="sale-item">',f+='<h4 class="look-title">'+i+"</h4>",f+='<p class="look-price">',f+='<q class="fn-rmb">&yen;</q><strong class="fn-rmb-num">'+o+"</strong>",f+="</p>",f+="</div>",f+="</a>",f+="</li>",t.append(f).show()}}}})};init()};return{main:itemmutual}});var QRCode;(function(){function e(e){this.mode=n.MODE_8BIT_BYTE,this.data=e,this.parsedData=[];for(var t=0,r=this.data.length;t<r;t++){var i=[],s=this.data.charCodeAt(t);s>65536?(i[0]=240|(s&1835008)>>>18,i[1]=128|(s&258048)>>>12,i[2]=128|(s&4032)>>>6,i[3]=128|s&63):s>2048?(i[0]=224|(s&61440)>>>12,i[1]=128|(s&4032)>>>6,i[2]=128|s&63):s>128?(i[0]=192|(s&1984)>>>6,i[1]=128|s&63):i[0]=s,this.parsedData.push(i)}this.parsedData=Array.prototype.concat.apply([],this.parsedData),this.parsedData.length!=this.data.length&&(this.parsedData.unshift(191),this.parsedData.unshift(187),this.parsedData.unshift(239))}function t(e,t){this.typeNumber=e,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.dataList=[]}function a(e,t){if(e.length==undefined)throw new Error(e.length+"/"+t);var n=0;while(n<e.length&&e[n]==0)n++;this.num=new Array(e.length-n+t);for(var r=0;r<e.length-n;r++)this.num[r]=e[r+n]}function f(e,t){this.totalCount=e,this.dataCount=t}function l(){this.buffer=[],this.length=0}function h(){return typeof CanvasRenderingContext2D!="undefined"}function p(){var e=!1,t=navigator.userAgent;if(/android/i.test(t)){e=!0;var n=t.toString().match(/android ([0-9]\.[0-9])/i);n&&n[1]&&(e=parseFloat(n[1]))}return e}function g(e,t){var n=1,i=y(e);for(var s=0,o=c.length;s<=o;s++){var u=0;switch(t){case r.L:u=c[s][0];break;case r.M:u=c[s][1];break;case r.Q:u=c[s][2];break;case r.H:u=c[s][3]}if(i<=u)break;n++}if(n>c.length)throw new Error("Too long data");return n}function y(e){var t=encodeURI(e).toString().replace(/\%[0-9a-fA-F]{2}/g,"a");return t.length+(t.length!=e?3:0)}e.prototype={getLength:function(e){return this.parsedData.length},write:function(e){for(var t=0,n=this.parsedData.length;t<n;t++)e.put(this.parsedData[t],8)}},t.prototype={addData:function(t){var n=new e(t);this.dataList.push(n),this.dataCache=null},isDark:function(e,t){if(e<0||this.moduleCount<=e||t<0||this.moduleCount<=t)throw new Error(e+","+t);return this.modules[e][t]},getModuleCount:function(){return this.moduleCount},make:function(){this.makeImpl(!1,this.getBestMaskPattern())},makeImpl:function(e,n){this.moduleCount=this.typeNumber*4+17,this.modules=new Array(this.moduleCount);for(var r=0;r<this.moduleCount;r++){this.modules[r]=new Array(this.moduleCount);for(var i=0;i<this.moduleCount;i++)this.modules[r][i]=null}this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(e,n),this.typeNumber>=7&&this.setupTypeNumber(e),this.dataCache==null&&(this.dataCache=t.createData(this.typeNumber,this.errorCorrectLevel,this.dataList)),this.mapData(this.dataCache,n)},setupPositionProbePattern:function(e,t){for(var n=-1;n<=7;n++){if(e+n<=-1||this.moduleCount<=e+n)continue;for(var r=-1;r<=7;r++){if(t+r<=-1||this.moduleCount<=t+r)continue;0<=n&&n<=6&&(r==0||r==6)||0<=r&&r<=6&&(n==0||n==6)||2<=n&&n<=4&&2<=r&&r<=4?this.modules[e+n][t+r]=!0:this.modules[e+n][t+r]=!1}}},getBestMaskPattern:function(){var e=0,t=0;for(var n=0;n<8;n++){this.makeImpl(!0,n);var r=s.getLostPoint(this);if(n==0||e>r)e=r,t=n}return t},createMovieClip:function(e,t,n){var r=e.createEmptyMovieClip(t,n),i=1;this.make();for(var s=0;s<this.modules.length;s++){var o=s*i;for(var u=0;u<this.modules[s].length;u++){var a=u*i,f=this.modules[s][u];f&&(r.beginFill(0,100),r.moveTo(a,o),r.lineTo(a+i,o),r.lineTo(a+i,o+i),r.lineTo(a,o+i),r.endFill())}}return r},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++){if(this.modules[e][6]!=null)continue;this.modules[e][6]=e%2==0}for(var t=8;t<this.moduleCount-8;t++){if(this.modules[6][t]!=null)continue;this.modules[6][t]=t%2==0}},setupPositionAdjustPattern:function(){var e=s.getPatternPosition(this.typeNumber);for(var t=0;t<e.length;t++)for(var n=0;n<e.length;n++){var r=e[t],i=e[n];if(this.modules[r][i]!=null)continue;for(var o=-2;o<=2;o++)for(var u=-2;u<=2;u++)o==-2||o==2||u==-2||u==2||o==0&&u==0?this.modules[r+o][i+u]=!0:this.modules[r+o][i+u]=!1}},setupTypeNumber:function(e){var t=s.getBCHTypeNumber(this.typeNumber);for(var n=0;n<18;n++){var r=!e&&(t>>n&1)==1;this.modules[Math.floor(n/3)][n%3+this.moduleCount-8-3]=r}for(var n=0;n<18;n++){var r=!e&&(t>>n&1)==1;this.modules[n%3+this.moduleCount-8-3][Math.floor(n/3)]=r}},setupTypeInfo:function(e,t){var n=this.errorCorrectLevel<<3|t,r=s.getBCHTypeInfo(n);for(var i=0;i<15;i++){var o=!e&&(r>>i&1)==1;i<6?this.modules[i][8]=o:i<8?this.modules[i+1][8]=o:this.modules[this.moduleCount-15+i][8]=o}for(var i=0;i<15;i++){var o=!e&&(r>>i&1)==1;i<8?this.modules[8][this.moduleCount-i-1]=o:i<9?this.modules[8][15-i-1+1]=o:this.modules[8][15-i-1]=o}this.modules[this.moduleCount-8][8]=!e},mapData:function(e,t){var n=-1,r=this.moduleCount-1,i=7,o=0;for(var u=this.moduleCount-1;u>0;u-=2){u==6&&u--;for(;;){for(var a=0;a<2;a++)if(this.modules[r][u-a]==null){var f=!1;o<e.length&&(f=(e[o]>>>i&1)==1);var l=s.getMask(t,r,u-a);l&&(f=!f),this.modules[r][u-a]=f,i--,i==-1&&(o++,i=7)}r+=n;if(r<0||this.moduleCount<=r){r-=n,n=-n;break}}}}},t.PAD0=236,t.PAD1=17,t.createData=function(e,n,r){var i=f.getRSBlocks(e,n),o=new l;for(var u=0;u<r.length;u++){var a=r[u];o.put(a.mode,4),o.put(a.getLength(),s.getLengthInBits(a.mode,e)),a.write(o)}var c=0;for(var u=0;u<i.length;u++)c+=i[u].dataCount;if(o.getLengthInBits()>c*8)throw new Error("code length overflow. ("+o.getLengthInBits()+">"+c*8+")");o.getLengthInBits()+4<=c*8&&o.put(0,4);while(o.getLengthInBits()%8!=0)o.putBit(!1);for(;;){if(o.getLengthInBits()>=c*8)break;o.put(t.PAD0,8);if(o.getLengthInBits()>=c*8)break;o.put(t.PAD1,8)}return t.createBytes(o,i)},t.createBytes=function(e,t){var n=0,r=0,i=0,o=new Array(t.length),u=new Array(t.length);for(var f=0;f<t.length;f++){var l=t[f].dataCount,c=t[f].totalCount-l;r=Math.max(r,l),i=Math.max(i,c),o[f]=new Array(l);for(var h=0;h<o[f].length;h++)o[f][h]=255&e.buffer[h+n];n+=l;var p=s.getErrorCorrectPolynomial(c),d=new a(o[f],p.getLength()-1),v=d.mod(p);u[f]=new Array(p.getLength()-1);for(var h=0;h<u[f].length;h++){var m=h+v.getLength()-u[f].length;u[f][h]=m>=0?v.get(m):0}}var g=0;for(var h=0;h<t.length;h++)g+=t[h].totalCount;var y=new Array(g),b=0;for(var h=0;h<r;h++)for(var f=0;f<t.length;f++)h<o[f].length&&(y[b++]=o[f][h]);for(var h=0;h<i;h++)for(var f=0;f<t.length;f++)h<u[f].length&&(y[b++]=u[f][h]);return y};var n={MODE_NUMBER:1,MODE_ALPHA_NUM:2,MODE_8BIT_BYTE:4,MODE_KANJI:8},r={L:1,M:0,Q:3,H:2},i={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},s={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){var t=e<<10;while(s.getBCHDigit(t)-s.getBCHDigit(s.G15)>=0)t^=s.G15<<s.getBCHDigit(t)-s.getBCHDigit(s.G15);return(e<<10|t)^s.G15_MASK},getBCHTypeNumber:function(e){var t=e<<12;while(s.getBCHDigit(t)-s.getBCHDigit(s.G18)>=0)t^=s.G18<<s.getBCHDigit(t)-s.getBCHDigit(s.G18);return e<<12|t},getBCHDigit:function(e){var t=0;while(e!=0)t++,e>>>=1;return t},getPatternPosition:function(e){return s.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,n){switch(e){case i.PATTERN000:return(t+n)%2==0;case i.PATTERN001:return t%2==0;case i.PATTERN010:return n%3==0;case i.PATTERN011:return(t+n)%3==0;case i.PATTERN100:return(Math.floor(t/2)+Math.floor(n/3))%2==0;case i.PATTERN101:return t*n%2+t*n%3==0;case i.PATTERN110:return(t*n%2+t*n%3)%2==0;case i.PATTERN111:return(t*n%3+(t+n)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){var t=new a([1],0);for(var n=0;n<e;n++)t=t.multiply(new a([1,o.gexp(n)],0));return t},getLengthInBits:function(e,t){if(1<=t&&t<10)switch(e){case n.MODE_NUMBER:return 10;case n.MODE_ALPHA_NUM:return 9;case n.MODE_8BIT_BYTE:return 8;case n.MODE_KANJI:return 8;default:throw new Error("mode:"+e)}else if(t<27)switch(e){case n.MODE_NUMBER:return 12;case n.MODE_ALPHA_NUM:return 11;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 10;default:throw new Error("mode:"+e)}else{if(!(t<41))throw new Error("type:"+t);switch(e){case n.MODE_NUMBER:return 14;case n.MODE_ALPHA_NUM:return 13;case n.MODE_8BIT_BYTE:return 16;case n.MODE_KANJI:return 12;default:throw new Error("mode:"+e)}}},getLostPoint:function(e){var t=e.getModuleCount(),n=0;for(var r=0;r<t;r++)for(var i=0;i<t;i++){var s=0,o=e.isDark(r,i);for(var u=-1;u<=1;u++){if(r+u<0||t<=r+u)continue;for(var a=-1;a<=1;a++){if(i+a<0||t<=i+a)continue;if(u==0&&a==0)continue;o==e.isDark(r+u,i+a)&&s++}}s>5&&(n+=3+s-5)}for(var r=0;r<t-1;r++)for(var i=0;i<t-1;i++){var f=0;e.isDark(r,i)&&f++,e.isDark(r+1,i)&&f++,e.isDark(r,i+1)&&f++,e.isDark(r+1,i+1)&&f++;if(f==0||f==4)n+=3}for(var r=0;r<t;r++)for(var i=0;i<t-6;i++)e.isDark(r,i)&&!e.isDark(r,i+1)&&e.isDark(r,i+2)&&e.isDark(r,i+3)&&e.isDark(r,i+4)&&!e.isDark(r,i+5)&&e.isDark(r,i+6)&&(n+=40);for(var i=0;i<t;i++)for(var r=0;r<t-6;r++)e.isDark(r,i)&&!e.isDark(r+1,i)&&e.isDark(r+2,i)&&e.isDark(r+3,i)&&e.isDark(r+4,i)&&!e.isDark(r+5,i)&&e.isDark(r+6,i)&&(n+=40);var l=0;for(var i=0;i<t;i++)for(var r=0;r<t;r++)e.isDark(r,i)&&l++;var c=Math.abs(100*l/t/t-50)/5;return n+=c*10,n}},o={glog:function(e){if(e<1)throw new Error("glog("+e+")");return o.LOG_TABLE[e]},gexp:function(e){while(e<0)e+=255;while(e>=256)e-=255;return o.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)};for(var u=0;u<8;u++)o.EXP_TABLE[u]=1<<u;for(var u=8;u<256;u++)o.EXP_TABLE[u]=o.EXP_TABLE[u-4]^o.EXP_TABLE[u-5]^o.EXP_TABLE[u-6]^o.EXP_TABLE[u-8];for(var u=0;u<255;u++)o.LOG_TABLE[o.EXP_TABLE[u]]=u;a.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){var t=new Array(this.getLength()+e.getLength()-1);for(var n=0;n<this.getLength();n++)for(var r=0;r<e.getLength();r++)t[n+r]^=o.gexp(o.glog(this.get(n))+o.glog(e.get(r)));return new a(t,0)},mod:function(e){if(this.getLength()-e.getLength()<0)return this;var t=o.glog(this.get(0))-o.glog(e.get(0)),n=new Array(this.getLength());for(var r=0;r<this.getLength();r++)n[r]=this.get(r);for(var r=0;r<e.getLength();r++)n[r]^=o.gexp(o.glog(e.get(r))+t);return(new a(n,0)).mod(e)}},f.RS_BLOCK_TABLE=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]],f.getRSBlocks=function(e,t){var n=f.getRsBlockTable(e,t);if(n==undefined)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+t);var r=n.length/3,i=[];for(var s=0;s<r;s++){var o=n[s*3+0],u=n[s*3+1],a=n[s*3+2];for(var l=0;l<o;l++)i.push(new f(u,a))}return i},f.getRsBlockTable=function(e,t){switch(t){case r.L:return f.RS_BLOCK_TABLE[(e-1)*4+0];case r.M:return f.RS_BLOCK_TABLE[(e-1)*4+1];case r.Q:return f.RS_BLOCK_TABLE[(e-1)*4+2];case r.H:return f.RS_BLOCK_TABLE[(e-1)*4+3];default:return undefined}},l.prototype={get:function(e){var t=Math.floor(e/8);return(this.buffer[t]>>>7-e%8&1)==1},put:function(e,t){for(var n=0;n<t;n++)this.putBit((e>>>t-n-1&1)==1)},getLengthInBits:function(){return this.length},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}};var c=[[17,14,11,7],[32,26,20,14],[53,42,32,24],[78,62,46,34],[106,84,60,44],[134,106,74,58],[154,122,86,64],[192,152,108,84],[230,180,130,98],[271,213,151,119],[321,251,177,137],[367,287,203,155],[425,331,241,177],[458,362,258,194],[520,412,292,220],[586,450,322,250],[644,504,364,280],[718,560,394,310],[792,624,442,338],[858,666,482,382],[929,711,509,403],[1003,779,565,439],[1091,857,611,461],[1171,911,661,511],[1273,997,715,535],[1367,1059,751,593],[1465,1125,805,625],[1528,1190,868,658],[1628,1264,908,698],[1732,1370,982,742],[1840,1452,1030,790],[1952,1538,1112,842],[2068,1628,1168,898],[2188,1722,1228,958],[2303,1809,1283,983],[2431,1911,1351,1051],[2563,1989,1423,1093],[2699,2099,1499,1139],[2809,2213,1579,1219],[2953,2331,1663,1273]],d=function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){function o(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg",e);for(var r in t)t.hasOwnProperty(r)&&n.setAttribute(r,t[r]);return n}var t=this._htOption,n=this._el,r=e.getModuleCount(),i=Math.floor(t.width/r),s=Math.floor(t.height/r);this.clear();var u=o("svg",{viewBox:"0 0 "+String(r)+" "+String(r),width:"100%",height:"100%",fill:t.colorLight});u.setAttributeNS("http://www.w3.org/2000/xmlns/","xmlns:xlink","http://www.w3.org/1999/xlink"),n.appendChild(u),u.appendChild(o("rect",{fill:t.colorLight,width:"100%",height:"100%"})),u.appendChild(o("rect",{fill:t.colorDark,width:"1",height:"1",id:"template"}));for(var a=0;a<r;a++)for(var f=0;f<r;f++)if(e.isDark(a,f)){var l=o("use",{x:String(f),y:String(a)});l.setAttributeNS("http://www.w3.org/1999/xlink","href","#template"),u.appendChild(l)}},e.prototype.clear=function(){while(this._el.hasChildNodes())this._el.removeChild(this._el.lastChild)},e}(),v=document.documentElement.tagName.toLowerCase()==="svg",m=v?d:h()?function(){function e(){this._elImage.src=this._elCanvas.toDataURL("image/png"),this._elImage.style.display="block",this._elCanvas.style.display="none"}function r(e,t){var n=this;n._fFail=t,n._fSuccess=e;if(n._bSupportDataURI===null){var r=document.createElement("img"),i=function(){n._bSupportDataURI=!1,n._fFail&&n._fFail.call(n)},s=function(){n._bSupportDataURI=!0,n._fSuccess&&n._fSuccess.call(n)};r.onabort=i,r.onerror=i,r.onload=s,r.src="data:image/gif;base64,iVBORw0KGgoAAAANSUhEUgAAAAUAAAAFCAYAAACNbyblAAAAHElEQVQI12P4//8/w38GIAXDIBKE0DHxgljNBAAO9TXL0Y4OHwAAAABJRU5ErkJggg==";return}n._bSupportDataURI===!0&&n._fSuccess?n._fSuccess.call(n):n._bSupportDataURI===!1&&n._fFail&&n._fFail.call(n)}if(this._android&&this._android<=2.1){var t=1/window.devicePixelRatio,n=CanvasRenderingContext2D.prototype.drawImage;CanvasRenderingContext2D.prototype.drawImage=function(e,r,i,s,o,u,a,f,l){if("nodeName"in e&&/img/i.test(e.nodeName))for(var c=arguments.length-1;c>=1;c--)arguments[c]=arguments[c]*t;else typeof f=="undefined"&&(arguments[1]*=t,arguments[2]*=t,arguments[3]*=t,arguments[4]*=t);n.apply(this,arguments)}}var i=function(e,t){this._bIsPainted=!1,this._android=p(),this._htOption=t,this._elCanvas=document.createElement("canvas"),this._elCanvas.width=t.width,this._elCanvas.height=t.height,e.appendChild(this._elCanvas),this._el=e,this._oContext=this._elCanvas.getContext("2d"),this._bIsPainted=!1,this._elImage=document.createElement("img"),this._elImage.alt="Scan me!",this._elImage.style.display="none",this._el.appendChild(this._elImage),this._bSupportDataURI=null};return i.prototype.draw=function(e){var t=this._elImage,n=this._oContext,r=this._htOption,i=e.getModuleCount(),s=r.width/i,o=r.height/i,u=Math.round(s),a=Math.round(o);t.style.display="none",this.clear();for(var f=0;f<i;f++)for(var l=0;l<i;l++){var c=e.isDark(f,l),h=l*s,p=f*o;n.strokeStyle=c?r.colorDark:r.colorLight,n.lineWidth=1,n.fillStyle=c?r.colorDark:r.colorLight,n.fillRect(h,p,s,o),n.strokeRect(Math.floor(h)+.5,Math.floor(p)+.5,u,a),n.strokeRect(Math.ceil(h)-.5,Math.ceil(p)-.5,u,a)}this._bIsPainted=!0},i.prototype.makeImage=function(){this._bIsPainted&&r.call(this,e)},i.prototype.isPainted=function(){return this._bIsPainted},i.prototype.clear=function(){this._oContext.clearRect(0,0,this._elCanvas.width,this._elCanvas.height),this._bIsPainted=!1},i.prototype.round=function(e){return e?Math.floor(e*1e3)/1e3:e},i}():function(){var e=function(e,t){this._el=e,this._htOption=t};return e.prototype.draw=function(e){var t=this._htOption,n=this._el,r=e.getModuleCount(),i=Math.floor(t.width/r),s=Math.floor(t.height/r),o=['<table style="border:0;border-collapse:collapse;" width='+t.width+" height="+t.height+">"];for(var u=0;u<r;u++){o.push("<tr>");for(var a=0;a<r;a++)o.push('<td style="border:0;border-collapse:collapse;padding:0;margin:0;width:'+i+"px;height:"+s+"px;background-color:"+(e.isDark(u,a)?t.colorDark:t.colorLight)+';"></td>');o.push("</tr>")}o.push("</table>"),n.innerHTML=o.join("");var f=n.childNodes[0],l=(t.width-f.offsetWidth)/2,c=(t.height-f.offsetHeight)/2},e.prototype.clear=function(){this._el.innerHTML=""},e}();QRCode=function(e,t){this._htOption={width:256,height:256,typeNumber:4,colorDark:"#000000",colorLight:"#ffffff",correctLevel:r.H},typeof t=="string"&&(t={text:t});if(t)for(var n in t)this._htOption[n]=t[n];typeof e=="string"&&(e=document.getElementById(e)),this._htOption.useSVG&&(m=d),this._android=p(),this._el=e,this._oQRCode=null,this._oDrawing=new m(this._el,this._htOption),this._htOption.text&&this.makeCode(this._htOption.text)},QRCode.prototype.makeCode=function(e){this._oQRCode=new t(g(e,this._htOption.correctLevel),this._htOption.correctLevel),this._oQRCode.addData(e),this._oQRCode.make(),this._el.title=e,this._oDrawing.draw(this._oQRCode),this.makeImage()},QRCode.prototype.makeImage=function(){typeof this._oDrawing.makeImage=="function"&&(!this._android||this._android>=3)&&this._oDrawing.makeImage()},QRCode.prototype.clear=function(){this._oDrawing.clear()},QRCode.CorrectLevel=r})(),define("lib/jquery/qrcode/qrcode",function(){}),define("controller/www/item_initial",["lib/common","config/item_config","controller/www/item_tools","controller/www/item_active","config/item_dialogs","lib/jquery/qrcode/qrcode",static_domain+"/js/controller/member/fnDialog.js"],function(e,t,n,r,i){var s=function(s){var o=s.base,u=s.spec.dis,a=s.spec.data.spec,f=s.singlecollocation.dis,l=s.multiproduct.dis,c=o.mainshop,h=s.data,p=function(){var i=e(".product-number"),u=e(".product-value-anything");Array.prototype.indexOf||(Array.prototype.indexOf=function(e){var t=this.length>>>0,n=Number(arguments[1])||0;n=n<0?Math.ceil(n):Math.floor(n),n<0&&(n+=t);for(;n<t;n++)if(n in this&&this[n]===e)return n;return-1});if(o.status=="1"){var a=e(".refer"),f=a.children(".send"),l=a.children(".attr"),h=a.children("del");t.arrIfno[0]=o.color_seq,t.arrIfno[1]=o.size_seq,t.sendhide=f.hasClass("hide")?"hide":"show",t.attrnone=l.css("display")=="none"?"none":"block",t.delnone=h.css("display")=="none"?"none":"block",t.mainpricetag=o.mainshop.sale_price_status==2?!0:!1,g(),y(),E(),x(),T(),u.show(),i.show(),m(),v()}else n.temp("S_product_null","J_product_null",{product_null:!0,msg:c.message}),i.hide(),n.burying_point(s,"");b(),N(),d(),r.main(s)},d=function(){(area_map!=null||area_map!="")&&e.ajax({url:detail_url+c_item+"/notice_arrival?area_map="+area_map+"&send_type="+send_type,dataType:"jsonp",success:function(e){e.code||i.checkareamap(e.data)}})},v=function(){u&&!a.size.length&&e(".J_etalon").parents("dl").hide()},m=function(){if(c.is_mobile_price==0)return!1;var t=new QRCode("vipCode",{width:150,height:150});t.makeCode(detail_url+c_item+"/"+c.sku_seq);var r=new Date,i=n.js_strto_time("",c.show_special_data.mobile_price_out_date),s=e("#vipCodeTime");s.attr("data-time",i[2]).show(),n.saleCountTime(s,i[0]>0?7:8)},g=function(){var t=s.skuSeq_list[s.base.sku_seq];if(t.sale_price_status==6){e(".groupby-pre_sale").removeClass("hide"),e(".fn-price-label").addClass("hide");return}if(o.is_ingeral==1){var r=t.privilege,i=r.sale_info,u=i.is_limit,a=i.limit_quantity,f=i.product_price,l=i.product_points;e(".fn-price-label").addClass("hide"),e(".fn-price-label").html(r.ingeral_type_title).removeClass("hide"),c.sale_price=f,n.temp("S_product_value","J_product_value",s.base),e(".product_points").html("+"+l),e(".integral_txt").html("积分"),e(".integral").show(),r.vip_title!=""&&e(".exclusive").html(r.vip_title).show(),u==1&&e("#ssm_limit_label").show().children("#ssm_limit").html(a)}else c.is_tuan==1?(e(".groupby-price-label").removeClass("hide"),e(".send").addClass("no-point"),e(".send").addClass("hide"),e(".fn-price-label").addClass("hide")):t.sale_price_status!=2?e(".fn-price-label").removeClass("hide"):t.sale_price<=t.it_mprice?(e(".fn-price-label").addClass("hide"),e(".ssm-price-label").removeClass("hide")):(e(".ssm-price-label").removeClass("hide"),e(".fn-price-label").addClass("hide"))},y=function(){var t=typeof c.suggestion_price!="undefined"?Number(c.suggestion_price):0,n=typeof c.it_mprice!="undefined"?Number(c.it_mprice):0,r=Number(e(".nett .fn-rmb-num").html()),i=!1,s=0,o="",u=e(".m_show_mprice"),a=u.children(".fn-rmb-num");t>0&&n>0?(s=Math.max(t,n),o=t>=n?"m_suggestion_price":"m_it_mprice",s>r&&(i=!0)):t>r?(s=t,o="m_suggestion_price",i=!0):n>r&&(s=n,o="m_it_mprice",i=!0),i&&(e("."+o).show(),a.html(s),u.show())},b=function(){var t=s.skuSeq_list[s.base.sku_seq];if(t.is_pre_order==1){var n=new Date(t.ref_etd_dt.replace(/-/g,"/"));n=n.getFullYear()+"年"+(n.getMonth()+1)+"月"+n.getDate()+"日";var r="<p>预计"+n+'后发货  本商品由<a href="javascript:;" class="gray">飞牛网</a>提供 <a href="http://sale.feiniu.com/help_center/hc-7.html" class="blue">运费说明<i class="simsun">&gt;&gt;</i></a></p>';e(".cast-point").html(r)}},w=function(){if(o.buy_type&&o.other_sm_seq){n.addData(e("li:not('.select') .c_mobile_url"),"href",detail_url+c_item+"/"+o.other_sm_seq);if(o.buy_type.select==1&&s.spec.dis){var t=s.spec_dict,r=s.smseq_list,i=s.spec.data.spec,u=i.size,a=u.length,f=i.color,l=f.length;if(!a)for(var c=0;c<l;c++){var h=t[f[c].seq+"_"],p=r[h.sm_seq];(h.mobile_sm_seq==null||h.mobile_sm_seq=="")&&p.sku_status==1&&e(".J_color").children("li").eq(c).removeClass("select").addClass("nosold")}else for(var c=0;c<l;c++)for(var d=0;d<a;d++){var h=t[f[c].seq+"_"+a[d].seq],p=r[h.sm_seq],v=0;(h.mobile_sm_seq==null||h.mobile_sm_seq=="")&&p.sku_status==1&&(e(".J_etalon").children("li").eq(d).removeClass("select").addClass("nosold"),v++),v==a&&e(".J_color").children("li").eq(c).removeClass("select").addClass("nosold")}}}},E=function(){o.is_fresh_prod==1&&c.sale_price_status==6&&e(".warm").hide()},S=function(){o.is_fresh_prod!=1&&custom_promise_num>0&&e(".warm").show()},x=function(){var t=e("#J_product_value"),r=c.pre_sale_data,i=c.is_tuan,s=c.sale_price_status,u=c.show_special_data;if(c.sale_price_status==6){var a=r.start_date,f=r.end_date,l=n.js_strto_time(a,f),h=e("#pre_sale_time");h.attr("data-time",l[2]).show(),n.saleCountTime(h,l[0]>0?4:5),l[0]==0&&h.addClass("width211"),t.find(".clue").show(),e(".product-time").show()}else{var l=null,p=e("#saleCountTime");if(i==1){var d=o.grouping,a=u.start_date,f=u.end_date;l=n.js_strto_time(a,f),t.find(".clue").hide()}else s==2&&i!=1?l=n.js_strto_time(u.start_date,u.end_date):o.is_ingeral||t.find(".clue").show();l!=null&&(l[0]>0?t.find(".onlylost").show().children("em").children("strong").html(l[0]):l[1]>0&&(p.attr("data-time",l[1]).show(),n.saleCountTime(p,0)))}},T=function(){if(u&&o.size_seq){var t=s.spec.data.spec.color,r=s.spec.data.spec.size,i=e(".J_color").find(".select").index(),a=e(".J_etalon").find(".select").index(),f=t[i],l=r[a];for(var c=0,h=f.size_seq;c<h.length;c++)if(!h[c][n.de_code(h[c].seq)])for(var p=0,d=e(".J_etalon").children("li");p<d.length;p++)e(d[p]).children("span").attr("data-id")==h[c]["seq"]&&e(d[p]).addClass("nosold");e(".J_color").children("li").addClass("nosold");for(var p=0,v=e(".J_color").children("li");p<v.length;p++)for(var c=0,m=l.color_seq;c<m.length;c++)m[c][m[c].seq]&&e(v[p]).children("span").attr("data-id")==m[c]["seq"]&&e(v[p]).removeClass("nosold")}},N=function(){var t=this,n=e(".J_tabFixed"),r=e(".product-main"),i=e(".addshop-tab"),s=e(".online_service"),o=e(".product-article"),u=o.find("[data-id^='p']"),a=e(".depict-left").find("a[data-role='text_nav']");e(window).on("scroll resize",function(){var t=e(this),u=t.scrollTop(),a=r.offset().top+r.height();u>=r.offset().top?s.css("position","fixed").show():s.css("position","absolute").hide(),u>=n.offset().top&&(n.addClass("fixed"),i.show()),u<o.offset().top&&(n.removeClass("fixed"),i.hide())})};p()};return{main:s}}),define("controller/www/item_level_city",["lib/common","controller/www/item_tools","config/item_config"],function(e,t,n){var r={cookieName:bc_code+"_dist",addCookieName:bc_code+"_dist_area",cookieExpires:365,cookiePath:"/",defaultCookieValue:"",defaultCode:[],defaultDist:[],fourAreaCode:[],callbackFun:new Object,selectList:"#selectList",selectDetail:"#selectDetail",selectProarea:".selectProarea",curSelect:"#curSelect",flag:!0,defineName:["省","市","区","镇"]};data.city_delivery=function(n){var s=n.data,o="",u=e(r.selectProarea),a=u.find(".proarea"),f=u.find("._tab").children(),l=u.find("._tabCont").children(),c={init:function(){var n=e.cookie(r.addCookieName).split("_");typeof e.cookie(r.cookieName)!="undefined"&&(r.selectCPG=e.cookie(r.cookieName).split("_")[0]),r.delivery_status=s.delivery_status,(s.delivery_status=="all"||s.delivery_status=="none")&&n.length>3&&(r.city_area_county=n,r.city_area_county.pop()),s.delivery_status!="none"?t.show_cart_btn(data):(i.delivery_showbtn(),t.is_itInType(data.base,0)),this.cur_city(r.city_area_county.length-1),e(r.curSelect).children("em").html(o)},bindEven:function(){e("body").on({mouseenter:this.staticFuns.city_show,mouseleave:this.staticFuns.city_hide},r.selectDetail),u.on("click","a[cur-close]",this.staticFuns.cur_close),u.on("click","._tab a:not(._cur)",this.staticFuns.city_tab),u.on("click","._cont a",this.staticFuns.city_choose)},staticFuns:{city_show:function(){c.autoWidth(),e(this).addClass("hover"),a.show()},city_hide:function(){r.flag&&(e(this).removeClass("hover"),a.hide())},city_tab:function(){var t=e(this),n=t.index();l.eq(n).find("._cur").removeClass("_cur"),c.cur_city(n),t.children("b").html("请选择"+r.defineName[n]),r.flag=!1},cur_close:function(){u.removeClass("hover"),a.hide()},city_choose:function(){var t=e(this),n=t.parents("div"),i=t.attr("data-cpg")||r.selectCPG,s=t.attr("data-code"),o=t.attr("title"),u=n.index(),a=r.city_area_county.length-1;r.selectCPG=i,r.city_area_county[u]=s,r.city_name[u]=o,u==3&&(r.flag=!0,c.setCookie()),u==2?(c.get_district(s,u+1),c.get_is_delivery(u+1)):c.get_district(s,u+1)}},cur_city:function(e){f.removeClass("_cur").hide(),f.eq(e).addClass("_cur").show(),l.hide(),l.eq(e).show();for(var t=0;t<=e;t++)f.eq(t).show().children("b").html(r.city_name[t]),o+=r.city_name[t]},autoWidth:function(){var e=u.find("._tab"),t=e.outerWidth(!0),n=e.find("a:visible").length,r=0;for(var i=0;i<n;i++)r+=e.find("a:visible").eq(i).outerWidth(!0);r>t&&e.find("a:visible").eq(n-1).find("b").css({width:e.find("a:visible").eq(n-1).find("b").width()-r+t+"px",overflow:"hidden"})},setCookie:function(){var t=new Date,n=new Date(t.getTime()+r.cookieExpires*24*60*60*1e3);e.cookie(r.cookieName,r.selectCPG+"_"+r.city_area_county[0],{expires:n,path:r.cookiePath,domain:www_domain_sub}),e.cookie(r.addCookieName,r.city_area_county.join("_"),{expires:n,path:r.cookiePath,domain:www_domain_sub}),location.reload()},get_district:function(n,i){e.ajax({type:"GET",dataType:"jsonp",jsonp:"callback",contentType:"application/x-www-form-urlencoded; charset=utf-8",global:!1,url:www_url+"ajax_common/get_district",data:{code:n},async:!1}).done(function(e){parseInt(e.code)||(t.temp("S_city"+e.data.type,"J_city"+e.data.type,{_code_city:e.data}),r.city_name[i]="请选择"+r.defineName[i],i!=3&&c.cur_city(i))})},get_is_delivery:function(t){e.ajax({type:"GET",dataType:"jsonp",jsonp:"callback",contentType:"application/x-www-form-urlencoded; charset=utf-8",global:!1,url:item_url.mall+"/get_page_detail_delivery_by_sku_seqs",data:{sku_seqs:data.base.sku_seq,c_dist_area:r.city_area_county}}).done(function(e){if(!parseInt(e.code)){var n=data.base.sku_seq,i=e.data.delivery_list;r.delivery_status=e.data.delivery_status;if(e.data.delivery_status=="part")return r.city_area_county[t]=i[n].ser_seq,c.cur_city(t),!1}r.city_area_county.length>3&&r.city_area_county.pop(),r.flag=!0,c.setCookie()})}};c.init(),c.bindEven()};var i={get_city_list:function(){(function(n){e.ajax({type:"GET",dataType:"jsonp",jsonp:"callback",contentType:"application/x-www-form-urlencoded; charset=utf-8",global:!1,url:www_url+"ajax_common/get_cdist_area_list",data:{c_dist_area:typeof e.cookie(bc_code+"_dist_area")!="undefined"?e.cookie(bc_code+"_dist_area"):default_dist_area}}).done(function(i){if(!parseInt(i.code)){r.city_name=new Array,r.city_area_county=e.cookie(r.addCookieName).split("_");var s=i.data,o=r.city_area_county;r.city_data_list=s;for(var u=0;u<o.length;u++){var a=s[o[u]];r.city_name.push(a.name),a.type&&t.temp("S_city"+a.type,"J_city"+a.type,{_code_city:a,defineCity:o[u+1]})}n(r)}else e.log(i.msg)})})(function(r){e.ajax({type:"GET",dataType:"jsonp",jsonp:"callback",contentType:"application/x-www-form-urlencoded; charset=utf-8",global:!1,url:www_url+"ajax_common/get_top_area",data:{}}).done(function(e){parseInt(e.code)||(t.temp("S_city","J_city",{data:e.data,defineCity:r.city_area_county[0]}),t.adaptation(data,{config:n,funName:"city_delivery",_data:{code:e.code}}))})})},get_is_delivery:function(){e.ajax({type:"GET",dataType:"jsonp",jsonp:"callback",contentType:"application/x-www-form-urlencoded; charset=utf-8",global:!1,url:item_url.mall+"/get_page_detail_delivery_by_sku_seqs",data:{sku_seqs:data.base.sku_seq,c_dist_area:e.cookie(r.addCookieName)}}).done(function(i){if(!parseInt(i.code)){r.delivery_status=i.data.delivery_status,t.adaptation(data,{config:n,funName:"city_delivery",_data:i});if(i.data.delivery_status=="part"){var s=data.base.sku_seq,o=i.data.delivery_list,u=e.cookie(r.addCookieName).split("_")[2],a=o[s].is_delivery,f=o[s].ser_seq;a==0&&(i.data.delivery_status="none"),r.city_area_county.length!=4&&(r.city_area_county[3]=f,t.temp("S_city4","J_city4",{_code_city:r.city_data_list[u],defineCity:f}),r.city_name[3]=e("#J_city4").find("._cur").html())}}})},delivery_showbtn:function(){var t=e(".addshop-create"),n=t.parent(".addshop-tab"),i=e(".beforebuy-txt"),s=e(".salepackage-btn"),o=e(".collocation-btn"),u=e(".J_isIPay");if(data.base.status!="1"||r.delivery_status=="none")r.delivery_status=="none"&&data.base.status=="1"&&i.html("抱歉，当前区域不在配送范围内"),s.addClass("ui-button-90-no"),s.removeClass("ui-button-90"),s.removeClass("salepackage-btn"),o.addClass("ui-button-90-no"),o.removeClass("ui-button-90"),o.removeClass("collocation-btn"),u.hide(),n.hide()}};return i}),define("controller/www/item_ajax",["lib/common","config/item_config","controller/www/item_comment","controller/www/item_tools","controller/www/item_initial","controller/www/item_level_city"],function(e,t,n,r,i,s){var o=function(o){var u=o.base,a=u.sku_seq,f=u.cp_seq,l=o.skuSeq_list[a],c=o.skuSeq_list[a],h=u.mainshop,p=o.verification,d=p.promotion_obj,v=p.arr,m=this;o.vendor_paytype=function(e){var t=e.data.final_promise||{},n=e.data.isIMarket||0,i=e.data.isIPay||0,s=new Array,o;n&&(t.isIMarket="自提服务"),i&&(t.isIPay="货到付款");for(o in t){var u={};u.finalClass="";if(!t.hasOwnProperty(o))continue;switch(o){case"n_stg":u.finalClass="seven-no",u.finalCode="&#xe62d;",u.finalName=t[o],s.push(u);break;case"stg":u.finalClass="seven",u.finalCode="&#xe62d;",u.finalName=t[o],s.push(u);break;case"qgw":u.finalCode="&#xe629;",u.finalName=t[o],s.push(u);break;case"spt":u.finalCode="&#xe628;",u.finalName=t[o],s.push(u);break;case"ibs":u.finalCode="&#xe627;",u.finalName=t[o],s.push(u);break;case"hds":u.finalCode="&#xe62c;",u.finalName=t[o],s.push(u);break;case"isIMarket":u.finalCode="&#xe075;",u.finalName=t[o],s.push(u);break;case"isIPay":case"cod":u.finalCode="&#xe62a;",u.finalName=t[o],s.push(u)}}s.length&&(r.temp("S_sevice","J_sevice",{finaldata:s}),r.show_temp(".sevice"))},o.custom_couponInfo=function(t){var n=t.data.c_service_status,i=t.data.desc||"",s=t.data.custom_promise||[];n&&e(".online_service").show(),i!=""&&s.push(i),s.length&&(r.temp("S_warm","J_warm",{customdata:s}),r.show_temp(".warm"))};var g=function(){u.is_ingeral||(w(),S(),A(),M()),T(),y(),b(),H(),j(),N(),E(),O(),_(),D(),P(),x(),L(),k(),B(),I(),q(),n.main(o),i.main(o)},y=function(){if(u.it_in_type==3&&u.is_fresh_prod!=1){var t=u.sup_name;t!=""&&t!=null&&e(".firm_name").html(t).show()}},b=function(){e.ajax({url:detail_url+c_item+"/get_icon_info_by_skuseqs?sku_seqs="+a,dataType:"jsonp",success:function(t){if(!t.code){var n=t.data,r=n[a].icon_list,i=r.small_pic,s=r.big_pic;i!=""&&e(".small_pic").attr("src",i).show(),s!=""&&e(".big_pic").attr("src",s).show()}}})},w=function(){if(u.status!="1")return!1;var t=h.sale_price_status,n=h.show_special_data,i=!0,s=u.it_in_type==4&&h.sale_price_status==2&&n.is_sell_over_limit!==0&&n.surplus_null!=1;if(u.status!="1"||t==6||(t==2||h.is_mobile_price==1||h.is_infant==1)&&!s&&t==7||h.is_pre_order==1||u.is_orgi_item==0)i=!1;if(t==3&&!s){var f={dis:!0,data:[{tag:"买立减",title:"下单立减"+(h.sale_price-n.ssm_price).toFixed(2)+"元",type:4,tag_status:!0}]};r.temp("S_promotion","J_promotion",f),r.show_temp("#J_promotion"),o.is_promotion||(o.is_promotion=!0,r.temp("S_is_promotion","J_is_promotion",{is_promotion:!0})),i=!1}e.ajax({url:detail_url+c_item+"/query_detail_page_activity?sku_seq="+a,dataType:"jsonp",success:function(s){if(!s.code){var u=s.data,a=u.xxhd,f=u.zp;i&&u.xxhd_status&&(t==3&&a.xxhd_data.unshift({tag:"买立减",title:"下单立减"+(h.sale_price-n.ssm_price).toFixed(2)+"元",type:4,tag_status:!0}),r.temp("S_promotion","J_promotion",a.xxhd_data),r.show_temp("#J_promotion"));if(u.zp_status){var l=f.zp_data.data;o.data.gifts=[],v.push("gifts"),e.extend(!0,o.spec_dict,f.spec_dict_list),e.extend(!0,o.skuSeq_list,f.skuSeq_list);for(var c in l){if(!l.hasOwnProperty(c))continue;l[c].spec_dis?l[c].exper="V_gifts":o.data.gifts[c]=l[c].sku_seq,l[c].specLength=l[c].is_spec==1?1:0,l[c].color_size_num=l[c].spec_dis==1?1:0,l[c].spec_dis&&(o[l[c].sku_seq+"_"+c]=l[c].spec,o[l[c].sku_seq+"_"+c].sku_seq=l[c].sku_seq+"_"+c,o[l[c].sku_seq+"_"+c].sm_seq=l[c].sku_seq+"_"+c)}e.extend(!0,o.gifts,f.zp_data),r.temp("S_gifts","J_gifts",{dis:!0,data:f.zp_data.data,condition:f.condition_num,condition_dis:!0,quantity:f.gift_quantity}),r.show_temp("#J_gifts")}o.is_promotion||(o.is_promotion=!0,r.temp("S_is_promotion","J_is_promotion",{is_promotion:!0}))}}})},E=function(){e.ajax({url:detail_url+c_item+"/getCategoryVendorByCpSeqAndSupSeq?cpSeq="+f+"&supSeq="+u.sup_seq+"&skuSeq="+h.sku_seq+"&itInType="+u.it_in_type+"&isFreshProd="+u.is_fresh_prod+"&v="+Date.parse(new Date),dataType:"json",success:function(e){r.adaptation(o,{config:t,funName:"vendor_paytype",_data:e}),r.adaptation(o,{config:t,funName:"custom_couponInfo",_data:e})}})},S=function(){if(h.sale_price_status==6)return!1;e.ajax({url:detail_url+c_item+"/autotrophy_combine?sku_seq="+a+"&sku_status="+l.sku_status,dataType:"jsonp",success:function(n){if(!n.code){var i=n.data;r.temp("S_package_list","J_package_list",{sale:i.tc_status,collo:i.jgp_status}),r.show_temp("#J_package_list");if(i.jgp_status){var a=i.jgp.jpg_data;o.collocation=i.jgp.jpg_data,e.extend(!0,o.skuSeq_list,i.jgp.skuSeq_list),e.extend(!0,o.spec_dict,i.jgp.spec_dict_list),a.dis&&(o.data.collocation0=[],o.collocationprice0=[],o.collocationsprice0=[],e.each(a.data,function(e,t){if(t.dis){var n=o.skuSeq_list[t.sku_seq];o.collocationprice0[e]=Number(n.sale_price),o.collocationsprice0[e]=Number(t.fn_price),r.is_spec(t,"collocation",0,1,e,o)}}),r.temp("S_collocation_list","J_collocation_list",{collo:a,base:o.base}),i.tc_status||r.show_temp("#J_collocation_list"),r.init_collocation(o,t))}if(i.tc_status){var f=i.tc.tc_data;o.salepackage=f,e.extend(!0,o.skuSeq_list,i.tc.skuSeq_list),e.extend(!0,o.spec_dict,i.tc.spec_dict_list);if(f.dis){o.salepackagesm_price=[],e.each(f.data,function(t,n){n.dis&&(o["salepackagemprice"+t]=[],o.salepackagesm_price.push(Number(n.suit_price)),o.data["salepackage"+t]=[],e.each(n.list,function(e,n){n.dis&&(o["salepackagemprice"+t][e]=Number(n.fn_price),r.is_spec(n,"salepackage",t,1,e,o))}))});var l=Number(o.salepackagesm_price[0]);e.extend(!0,u,{salecount:l}),r.temp("S_salepackage_list","J_salepackage_list",{sale:f,base:o.base}),r.show_temp("#J_salepackage_list"),r.init_salepackage(o,t)}}e(".package").show(),s.delivery_showbtn()}}})},x=function(){if(h.sale_price_status==6)return!1;var t=new Date,n=t.getTime(),i="";e.ajax({url:detail_url+c_item+"/getDistributionTimeForDetailPage?whg_seq="+u.whg_seq+"&cp_seq="+f,dataType:"jsonp",success:function(t){if(t.code==0&&r.is_empty_obj(t.data)){var s=t.data,o=parseInt(s.deliveryTime),u=o-1,a=u*24*60*60*1e3,f=r.formatDate(new Date(n+a),"MM月dd日"),l="";switch(u){case 0:l="预计今天";break;case 1:l="预计明天";break;case 2:l="预计后天"}i+=s.endDate+"前完成下单，",i+=l+"<strong>（"+f+"）</strong>送达",i+=s.described,e("#precisionHtml").html(i)}}})},T=function(){if(h.sale_price_status==6)return!1;e.ajax({url:detail_url+c_item+"/getOrderForHBCommoditySell?sell_id="+u.itno+"&category_id="+f+"&amount="+o.current_price,dataType:"jsonp",success:function(e){var n=e.data,i=0,s=null,u=0,a=0;if(!e.code&&n.isues){s=n.hb_list,t.huabei={min_money:n.min_money,max_money:n.max_money,free_min_money:n.free_min_money,free_max_money:n.free_max_money};for(u;u<s.length;u++)s[u].free_hb_percent==100&&(i=s[u].free_hb_percent,a<s[u].hb_num&&(a=s[u].hb_num,o.maxPercent=a));r.temp("S_huabei","J_huabei",{dis:!0,huabei:n,maxPercent:a}),r.show_temp("#J_huabei")}}})},N=function(){if(h.sale_price=="")return!1;var n=e(".sevice"),i=typeof u.buy_type=="undefined"||u.buy_type==null?0:1,s=typeof u.grouping=="undefined"||u.grouping==null?0:1,a=o._weight.length>=1?o._weight.join(","):0,f=o._length.length>=1?o._length.join(","):0,l=o._height.length>=1?o._height.join(","):0,c=o._width.length>=1?o._width.join(","):0,p=o._volume.length>=1?o._volume.join(","):0,d=o._largeVolume.length>=1?o._largeVolume.join(","):0,v=h.sale_price_status==6?1:0;e.ajax({url:detail_url+c_item+"/is_imarket_paytype",data:"weight="+a+"&length="+f+"&height="+l+"&width="+c+"&volume="+p+"&isLargeVolume="+d+"&price="+o.current_price+"&isPreSale="+v+"&isPreOrder=0"+"&isFreshProd="+u.is_fresh_prod+"&it_in_type="+u.it_in_type+"&buy_type="+i+"&is_group="+s+"&isSensitive="+u.is_sensitive+"&type=0",dataType:"jsonp",success:function(e){r.adaptation(o,{config:t,funName:"vendor_paytype",_data:e})}})},C=function(){if(u.status!="1")return!1;typeof is_warranty!="undefined"&&is_warranty&&u.is_orgi_item&&h.sale_price_status!=6&&e.ajax({url:detail_url+c_item+"/yanbao_list?commodityIds="+u.itno+"&is_mall=0&v="+Date.parse(new Date),dataType:"jsonp",success:function(e){var t=!1;if(e.code==0){var n=null,i=0,s=null,o=[],u=e.data;t=!0;for(n in u){if(!u.hasOwnProperty(n))continue;var a=u[n];for(i;i<a.length;i++){var f=a[i],l=f.yanbaoInfos;f.defineInfo=l[0],f.yanbaoInfos_dis=!0,l.length==1&&(f.yanbaoInfos_dis=!1),o.push(f)}r.temp("S_yanbao","J_yanbao",{yanbao_dis:t,data:o}),r.show_temp("#J_yanbao")}}}})},k=function(){var t=detail_url+c_item+"/get_seo_words?word="+min_crumb_name;e.ajax({url:t,dataType:"jsonp",success:function(t){if(t.code==0&&t.data.length){e(".side-seo-words").empty();var n=t.data;for(var r=0;r<n.length;r++){var i="<a href='"+www_domain+"/hotkey_goods/"+n[r].id+"'  target='_blank'>"+n[r].word+"</a>";e(".side-seo-words").append(i).parent().show()}}}})},L=function(){var t=detail_url+c_item+"/seo_commentbrand?avseq="+brandId+"&cpseq="+f;e.ajax({url:t,dataType:"jsonp",success:function(t){if(t.code==0){e(".side-seo-commentbrand").empty();var n=t.data.list;for(var r=0;r<n.length;r++){var i="<a href='"+www_domain+"/cbrand/"+n[r].avseq+"'  target='_blank'>"+n[r].brand_name+"</a>";e(".side-seo-commentbrand").append(i)}}}})},A=function(){if(u.is_integral_privilege==1&&h.sale_price_status!=6){var n=l.qty,i=Number(h.sale_price);e.ajax({url:detail_url+c_item+"/get_integral_activity?sku_seqs="+a,dataType:"jsonp",success:function(e){var s=e.data;if(!e.code&&r.is_empty_obj(s)){var u=s.list[a],f=u.sale_info,l=Number(f.product_price),c=Number(f.bonus_price);u.remainder_quantity&&n&&l<i&&c<=i&&(t._privilege=1,r.temp("S_privilege","J_privilege",u),r.show_temp("#J_privilege"),o.is_promotion||(o.is_promotion=!0,r.temp("S_is_promotion","J_is_promotion",{is_promotion:o.is_promotion})))}}})}},O=function(){e.ajax({url:ac_url+"/have_collect/v1?favorite_seq="+a+"&v="+Date.parse(new Date),dataType:"jsonp",success:function(t){t.code==0&&t.data.have&&(e("#collectLink i").removeClass("collect-ico-null"),e("#collectLink i").addClass("collect-ico-ok"),e("#collectLink .collect-text").text("已收藏"))}})},M=function(){var t=this,n=o.skuSeq_list,r="",i="";for(var s in n){if(!n.hasOwnProperty(s))continue;r+=","+s}r=r.substr(1,r.length),i=detail_url+c_item+"/get_sale_score?sku_seqs="+r+"&v="+Date.parse(new Date),e.ajax({url:i,dataType:"jsonp",success:function(t){if(t.code==0){var n=0,r="",i=t.data.resultList;for(var s=0;s<i.length;s++){if(i[s].skuSeq==a){if(i[s].multiple>1&&i[s].totalScore>0)return u.point=0,r="购买可得"+i[s].multiple+"倍  共"+i[s].totalScore+"积分",u.is_orgi_item==0&&(r="购买可得多倍积分  共"+i[s].totalScore+"积分"),e(".point-title").html(r).addClass("colC70034"),e(".send").removeClass("hide"),!1;u.point=i[s].totalScore}if(i[s].totalScore<n||n==0)n=i[s].totalScore}u.min_point=n,u.point>0&&!e(".send").hasClass("no-point")&&(e(".send").removeClass("hide"),e(".send #point").html(u.point))}}})},_=function(){var t=detail_url+c_item+"/rec_look_again?sku_seq="+a;e.ajax({url:t,dataType:"json",success:function(t){if(t.code==0){var n=t.data.list;e(".item-cf ul").empty();var r=function(t,n,r,i,s){var o="<li>";o+='<a href="'+t+'" class="look-img"  target="_blank"><img src="'+n+'" alt=""></a>',o+='<h4 class="look-title"><a href="'+t+'" target="_blank">'+r+"</a></h4>",o+='<p class="look-price">',o+='<q class="fn-rmb">&yen;</q><strong class="fn-rmb-num">'+s+"</strong>",typeof i!="undefined"&&i!=""&&i>s&&(o+='<del><q class="fn-rmb">&yen;</q><strong class="fn-rmb-num">'+i+"</strong></del>"),o+="</p></li>",e(".item-cf ul").append(o)},i=function(t,n,r,i){var s="<li>";s+='<a href="'+a+'" class="watch-img"  target="_blank"><img src="'+t+'" alt="">',s+="</a>",s+='<h4><a href="'+a+'"  target="_blank">'+n+"</a></h4>",s+="<p>",s+='<q class="fn-rmb">&yen;</q><strong class="fn-rmb-num">'+r+"</strong>",typeof i!="undefined"&&i!=""&&i>r&&(s+='<del><q class="fn-rmb">&yen;</q><strong class="fn-rmb-num">'+i+"</strong></del>"),s+="</p>",s+="</li>",e(".watch-list").append(s)};for(var s=0;s<n.length;s++){if(s>3)break;var o=n[s].id,u=n[s].title,a=detail_url+c_item+"/"+o,f=n[s].pic,l=n[s].price,c=n[s].it_mprice;s<3&&r(a,f,u,c,l),i(f,u,l,c)}var h=1,p=3,d=parseInt(n.length/p);e(".item-cf .barter").click(function(){e(".item-cf ul li").remove();for(var t=h*p;t<h*p+3;t++){if(t==n.length){h=0;break}var i=n[t].id,s=n[t].title,o=detail_url+c_item+"/"+i,u=n[t].pic,a=n[t].price,f=n[t].it_mprice;r(o,u,s,f,a)}h==d-1?h=0:h++})}}})},D=function(){var t=detail_url+c_item+"/small_category?category="+f;e.ajax({url:t,dataType:"json",success:function(t){if(t.code==0){var n=t.data.list;for(var r=0;r<n.length;r++){if(r>11)break;var i="<a href='"+search_domain+"?q="+n[r].name+"'  target='_blank'>"+n[r].name+"</a>";e(".side-related-inner").append(i)}}}})},P=function(){var t=detail_url+c_item+"/recbuyagain?sku_seq="+a;e.ajax({url:t,dataType:"json",success:function(t){if(t.code==0){var n=t.data.list;for(var r=0;r<n.length;r++)if(r<4){var i=n[r].id,s=n[r].title,o=detail_url+c_item+"/"+i,u=n[r].pic,a=n[r].price,f=n[r].it_mprice,l="<li>";l+='<a href="'+o+'" class="watch-img"  target="_blank"><img src="'+u+'" alt="">',l+="</a>",l+='<h4><a href="'+o+'"  target="_blank">'+s+"</a></h4>",l+="<p>",l+='<q class="fn-rmb">&yen;</q><strong class="fn-rmb-num">'+a+"</strong>",typeof f!="undefined"&&f!=""&&f>a&&(l+='<del><q class="fn-rmb">&yen;</q><strong class="fn-rmb-num">'+f+"</strong></del>"),l+="</p>",l+="</li>",e(".buy-list").append(l)}}}})},H=function(){var t=l;if(u.status!="1"||t.sale_price_status==6)return!1;var n=detail_url+c_item+"/voucher_list?sku_seq="+a;e.ajax({url:n,dataType:"jsonp",success:function(t){var n=t.data,i=null;t.code==0&&n&&(i=o.voucher,n.num=n.data.length,e.extend(!0,o,{voucher:n}),n.dis&&(r.temp("S_voucher","J_voucher",n),r.show_temp("#J_voucher")),o.is_promotion||(o.is_promotion=n.dis,r.temp("S_is_promotion","J_is_promotion",{is_promotion:n.dis})))}})},B=function(){var t="",n=0,r=null,i=e("#todayRec");e.get(detail_url+c_item+"/get_ad_list",{sm_seq:a},function(e){r=e.data.ads_list;if(e.code===0&&r){t+='<ul class="s-lst slider-main">';for(;n<r.length;n++)t+="<li>",t+='<a href="'+r[n].ad_url+'" title="'+r[n].ad_name+'">',t+='<img src="'+r[n].ad_img+'" width="750" height="150"/>',t+="</a>",t+="</li>";t+="</ul>",i.html(t),r.length==1?i.show():i.fn_slide({type:"move",duration:600,has_ctrl:!0,hide_page_btn:!0,has_num:!1}).show()}},"jsonp")},j=function(n){e.ajax({url:detail_url+c_item+"/get_coupon_info?sku_seq="+a+"&v="+Date.parse(new Date),dataType:"json",success:function(e){r.adaptation(o,{config:t,funName:"custom_couponInfo",_data:e})}})},F=function(){if(u.status!="1")return!1;e.ajax({url:detail_url+c_item+"/get_category?cp_seq="+f+"&v="+Date.parse(new Date),dataType:"jsonp",success:function(e){if(e.code==0&&e.data){var t=e.data.is_old_for_new==1?1:0;if(!t)return!1;r.temp("S_category","J_category",e.data),r.show_temp("#J_category")}}})},I=function(){e.ajax({url:domain_config.zydetail_protocol+"/detail/getAdvertismentImage?sku_id="+a+"&supSeq="+u.sup_seq+"&type=0&token=detail&provinceCode="+e.cookie(bc_code+"_dist_area").split("_")[0],dataType:"jsonp",success:function(t){if(t.state==1)for(var n=t.datas.length-1;n>=0;n--){var r=t.datas[n],i=r.imageUrl,s=r.imageLink?r.imageLink:"javascript:;",o="cursor:"+(r.imageLink?"pointer":"default"),u=r.advertismentName;e("#advertisment").show().prepend("<a href="+s+" style="+o+"><img style='margin-bottom:10px;' src="+i+" alt="+u+"/></a>")}}})},q=function(){var t=e(".J_deliveryTips"),n=e(".J_SupFreightMsg");if(u.it_in_type!=3||h.sale_price=="")return!1;if(!h.is_delivery)return t.addClass("hide"),n.html("该地区暂不支持配送").removeClass("hide"),!1;e.ajax({url:detail_url+c_item+"/getSupFreightMsg?sup_seq="+u.sup_seq+"&price="+h.sale_price,dataType:"jsonp",success:function(e){if(e.code==0){var r=e.data.desc;t.addClass("hide"),n.html(r).removeClass("hide")}}})};g()};return{main:o}}),define("controller/www/item_analysis",["lib/common","controller/www/item_ajax","controller/www/item_tools","controller/www/item_level_city"],function(e,t,n,r){var i=function(i){var s={},o=i.base,u=i.spec,a=u.data,f=i.skuSeq_list,l=i.combina,c=i.multiproduct,h=i.singlecollocation,p=f[o.sku_seq],d,v,m,g,y,b,w={init:function(){r.get_is_delivery();if(o.status!="1")return this.base(),t.main(i),!1;this.base(),this.combina(),this.spec(),this.multiproduct(),this.singlecollocation(),t.main(i)},base:function(){e.extend(!0,i,{data:{},show_hide_spec:null,is_promotion:!1,verification:{promotion_obj:{},arr:[]},_weight:[],_length:[],_height:[],_width:[],_volume:[],_largeVolume:[],current_price:null,maxPercent:0,base:{mainshop:p}}),m=i.data,g=i.verification,y=g.promotion_obj,b=g.arr,o.is_orgi_item>0&&(m.combina=[],m.combina.push(f[o.sku_seq].sku_seq),i._weight.push(o.weight),i._length.push(o.length),i._height.push(o.height),i._width.push(o.width),i._volume.push(o.volume),i._largeVolume.push(o.it_large_volume)),i.current_price=p.sale_price,S.base()},combina:function(){l.dis&&(x("combina"),C(l.data,"combina"),S.combina())},spec:function(){u.dis&&(d=o.color,v=o.size,u.experC="",u.experE="",e.extend(!0,i,{show_hide_spec:{dis:i.spec.dis,color:d!=null?'"'+d+'"':!1,size:v!=null?'"'+v+'"':!1}}),T(),S.spec())},multiproduct:function(){c.dis&&S.multiproduct()},singlecollocation:function(){h.dis&&S.singlecollocation()}},E={gifts:"choose",combina:"choose",spec:"select",color:"select",size:"select",singlecollocation:"select",multiproduct:"select",salepackage:"choose",collocation:"choose"},S={base:function(){n.temp("S_product_value","J_product_value",i.base),n.temp("S_addshop_tab","J_addshop_tab",i.base),p.sale_price_status==6&&(n.temp("S_pre_sale","J_pre_sale",{is_pre_sale:!0,pre_sale:p.pre_sale_data,amounts:parseInt(p.pre_sale_data.amount+p.pre_sale_data.stockPay)}),n.temp("S_pre_sale_reservation_time","J_pre_sale_reservation_time",{pre_sale_dis:!0}),n.show_temp("#J_pre_sale"),n.show_temp("#J_pre_sale_reservation_time"));if(p.is_mobile_price==1||p.is_infant==1)n.temp("S_vip_code","J_vip_code",p),n.show_temp("#J_vip_code")},combina:function(){n.temp("S_combina","J_combina",i.combina),n.show_temp("#J_combina"),i.combina.dis&&(i.is_promotion=i.combina.dis,n.temp("S_is_promotion","J_is_promotion",{is_promotion:i.is_promotion}))},spec:function(){n.temp("S_color_format","J_color_format",{dis:i.spec.dis,spec:i.spec.data.spec,base:i.base,experC:i.spec.experC,experE:i.spec.experE}),n.temp("S_showhide_spec","J_showhide_spec",i.show_hide_spec),n.show_temp("#J_color_format"),n.show_temp("#J_showhide_spec")},multiproduct:function(){n.temp("S_package","J_package",i.multiproduct),n.show_temp("#J_package")},singlecollocation:function(){n.temp("S_format","J_format",i.singlecollocation),n.show_temp("#J_format")}},x=function(e){b.push(e),y[e]={dis:!0,v:E[e]},m[e]=[]},T=function(){if(!u.is_spec)return x("color"),!1;x("color"),x("size");var e=a.spec,t=e.color,n=e.size,r=i.base;N(t,r.color_seq,r.size_seq,"size_seq",n),N(n,r.size_seq,r.color_seq,"color_seq",t)},N=function(e,t,n,r,i){var s=[];for(var u=0;u<e.length;u++){o.is_ingeral==1&&(e[u].is_display=1);if(t==e[u].seq)for(var a=0,f=e[u][r];a<f.length;a++)s.push(f[a].seq)}for(var l=0;l<s.length;l++)for(var c=0;c<i.length;c++)s[l]==i[c].seq&&(i[c].type=1)},C=function(t,r){e.each(t,function(e,t){n.is_spec(t,r,e,0,e,i),i._weight.push(t.weight),i._length.push(t.length),i._height.push(t.height),i._width.push(t.width),i._volume.push(t.volume),i._largeVolume.push(t.it_large_volume)})};w.init()};return{main:i}}),define("controller/www/item",["lib/common","config/item_config","controller/www/item_tools","controller/www/item_analysis","controller/www/item_level_city",static_domain+"/product/js/lib/upLogger.js",static_domain+"/product/js/lib/idigger.js"],function(e,t,n,r,i){var s=this,o=data,u=o.base,a=u.sku_seq,f=o.skuSeq_list,l=o.main_skuSeq_list,c=f[a],h=u.range_price,p=o.base.is_orgi_item,d=n.is_obj(f);c_item="",window.detail_url=item_url.mall,window.location.host.indexOf("www")!=-1&&(window.detail_url=item_url.item),function(s){var l={get_integral_privilege:function(){u.is_integral_privilege==1&&e.ajax({url:detail_url+c_item+"/get_integral_activity?sku_seqs="+a,dataType:"jsonp",success:function(e){n.adaptation(o,{config:t,funName:"price_privilege",_data:e})}})},get_price_qty_sku:function(){e.ajax({url:detail_url+c_item+"/price_qty_sku?sku_seqs="+d,dataType:"jsonp",success:function(e){e.code==0&&!u.is_ingeral?s(e.data):n.adaptation(o,{config:t,funName:"price_privilege",_data:e})},error:function(t){e.log(t)}})}};o.price_privilege=function(t){var n=t.data;if(typeof n.list!="undefined"&&n.skuSeq_list[a]!="undefined"){var i=n.skuSeq_list[a],s=n.list[a],l=s.sale_info,h=Number(l.product_price),p=Number(l.bonus_price),d=Number(i.sale_price);e.extend(!0,f,n.skuSeq_list),s.remainder_quantity&&i.qty&&h<d&&p<=d?(c.qty=s.remainder_quantity,c.privilege=s):u.status=0}else u.status=0;r.main(o)},u.is_ingeral?(l.get_price_qty_sku(),l.get_integral_privilege()):l.get_price_qty_sku(),i.get_city_list()}(function(t){var i=function(){var i={_skuSeq_list_clone:t.skuSeq_list,_skuSeq_seq_clone:t.skuSeq_list[a],update_skuSeq:function(){u.status=this._skuSeq_list_clone[a].sku_status,e.extend(!0,f,t.skuSeq_list)},count_price_range:function(){var e=this._skuSeq_list_clone;for(var t in e){if(!e.hasOwnProperty(t))continue;var n=e[t],r=Number(n.sale_price);if(n.sku_status==0)continue;if(r>h.max||h.max==0)h.max=r;if(r<h.min||h.min==0)h.min=r}h.min==0||h.max==0||h.max<=h.min?h.is_show=0:h.is_show=1},update_multiproduct:function(){var e=n.returnObj(o.multiproduct);if(e)for(var t in e){if(!e.hasOwnProperty(t))continue;var r=e[t].sku_seq,i=Number(this._skuSeq_list_clone[r].sale_price);e[t].sm_price=(i/e[t].qty).toFixed(2),e[t].sm_total_price=i}},spec_dis:function(){!o.spec.is_spec||!n.is_empty_obj(o.spec.data)?o.spec.dis=!1:(n.set_qty(o.spec.data.spec,1,0,o),o.spec.dis=!0)},sm_item_dis:function(){if(p==1||p==2)p==2?this._skuSeq_seq_clone.qty-=u.mult_qty:this._skuSeq_seq_clone.qty--;else{var t=n.returnObj(o.combina);if(t){for(var r in t){if(!t.hasOwnProperty(r))continue;var i=t[r].spec;if(typeof i!="undefined"&&i){var s=n.set_qty(i,1,0,o),a=t[r].sku_seq;s.dis&&e.extend(!0,t[r],s.display_sm),this._skuSeq_list_clone[a].qty--}}o.combina.dis=!0}}}};return{facade:function(){u.link=detail_url+c_item,i.update_skuSeq(),i.update_multiproduct(),i.spec_dis(),i.sm_item_dis(),i.count_price_range(),r.main(o)}}}();i.facade()})});